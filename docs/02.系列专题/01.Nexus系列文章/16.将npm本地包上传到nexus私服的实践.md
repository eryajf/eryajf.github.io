---
title: å°†npmæœ¬åœ°åŒ…ä¸Šä¼ åˆ°nexusç§æœçš„å®è·µ
date: 2022-09-20 23:11:24
permalink: /pages/18ca89/
categories:
  - ç³»åˆ—ä¸“é¢˜
  - Nexusç³»åˆ—æ–‡ç« 
tags:
  -
feed:
  enable: true
description: æœ¬æ–‡æ¥ä»‹ç»å½“æˆ‘ä»¬çš„npmç§æœé…ç½®å®Œæ¯•ä¹‹åï¼Œå¦‚ä½•ä¸Šä¼ åˆ°nexusç§æœä¸­
---


## 1ï¼Œå‰è¨€

å¦‚ä½•é…ç½® npm ç§æœï¼Œè¿™ä¸ªé—®é¢˜å¾ˆæ—©ä¹‹å‰å°±å·²ç»ç ”ç©¶è¿‡ï¼Œåšå®¢ä¹Ÿå‘è¡¨è¿‡æ­¤æ–‡ç« ï¼š [ä½¿ç”¨ nexus3 é…ç½® npm ç§æœ‰ä»“åº“](https://wiki.eryajf.net/pages/1956.html) ï¼Œæœ¬æ–‡æ¥ä»‹ç»å½“æˆ‘ä»¬ç§æœé…ç½®å®Œæ¯•ä¹‹åï¼Œå¦‚ä½•ä¸Šä¼ åˆ°nexusç§æœä¸­ã€‚

è¿™ä¸ªé€»è¾‘è·Ÿ Python ç§æœæœ‰ç‚¹ç±»ä¼¼ï¼š

å…¶å®ç”¨ä¸€å¥è¯æ¥è¡¨è¿°ï¼Œå°±æ˜¯ ` é€šè¿‡ç§æœæ‹‰åŒ…çš„æ—¶å€™ï¼Œèµ° group çš„ä»£ç†ï¼Œä»æœ¬åœ°ä¸Šä¼ åŒ…çš„æ—¶å€™ï¼Œè¦èµ° local çš„ä»“åº“ã€‚`

æ¥ä¸‹æ¥å°±è®°å½•ä¸€ä¸‹é…ç½®æ–¹æ³•å¹¶ç”¨æµ‹è¯•åŒ…æ¥éªŒè¯ä¸‹ã€‚

åˆ›å»ºç§æœçš„è¿‡ç¨‹è¿™é‡Œä¸è¯¦è¿°äº†ï¼Œå·²çŸ¥ç°æœ‰ npm ç§ä»“ï¼Œç‰©æ–™ä¿¡æ¯å¦‚ä¸‹ï¼š

- groupï¼šhttp://192.168.31.68:8931/repository/npm/
- localï¼šhttp://192.168.31.68:8931/repository/npm-local/

æœ¬æ–‡å°†ä»‹ç»ä¸€ä¸ªé€šè¿‡æœ¬åœ°ä¸Šä¼ çš„æ–¹å¼å¤„ç†åŒ…ä¾èµ–çš„æµç¨‹ã€‚

## 2ï¼Œå‡†å¤‡

è¿™ä¸ªé…ç½®è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ‰ä¸€äº›åœ°æ–¹æ²¡æœ‰é…ç½®æ­£ç¡®ï¼Œå°†ä¼šé‡åˆ°ä¸€äº›é”™è¯¯ï¼Œè¿™é‡Œå…ˆä»‹ç»èƒ½å¤Ÿæ­£å¸¸èµ°é€šçš„æµç¨‹ï¼Œæœ€åå†æ±‡æ€»è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ã€‚

é¦–å…ˆå› ä¸ºä¸ç§æœäº¤äº’éœ€è¦ä¸€ä¸ªè´¦å·ï¼Œå› æ­¤æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„è´¦å·æ¥ä¸ npm ç§æœäº¤äº’ã€‚

nexus ä¸­è´¦å·çš„ç®¡ç†æ€è·¯æ˜¯ï¼Œå…ˆåˆ›å»ºè§’è‰²ï¼Œç„¶åç»™è§’è‰²ç»‘å®šä¸åŒçš„ç®¡ç†æƒé™ï¼Œæ¥ç€åˆ›å»ºè´¦å·ï¼Œå°†è´¦å·ç»‘å®šç»™ä¸åŒçš„è§’è‰²ã€‚

å…ˆåˆ›å»ºè§’è‰²ï¼š

![](http://t.eryajf.net/imgs/2022/09/afa6929b47059291.png)

è¿™é‡Œåˆ›å»ºä¸€ä¸ª nx-npm çš„è§’è‰²ï¼Œè¯¥è§’è‰²æ‹¥æœ‰ npm æ–¹é¢æ‰€æœ‰çš„æƒé™ï¼Œè¿™å¯èƒ½æ˜¯ä¸ªæ¯”è¾ƒå¤§çš„æƒé™ï¼Œæˆ‘æ²¡æœ‰æµ‹è¯•è¿‡ä¸Šä¼ æ‰€éœ€çš„æœ€å°æƒé™ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è‡ªè¡Œæµ‹è¯•ä¸€ä¸‹ã€‚

ç„¶ååˆ›å»ºç”¨æˆ·ï¼š

![](http://t.eryajf.net/imgs/2022/09/e553a28081843017.png)

åŸºæœ¬ä¸Šéƒ½æ˜¯å¸¸è§„å†…å®¹ï¼Œä¸åšè¿‡å¤šèµ˜è¿°ã€‚

æ³¨æ„ç»™ç”¨æˆ·ç»‘å®š nx-npm è¿™ä¸ªè§’è‰²ã€‚

é…ç½® nexus ä¸­å®‰å…¨æ–¹é¢çš„ä¸€ä¸ªè§„åˆ™ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹å›¾ï¼Œå¦‚æœè¿™æ­¥ä¸æ“ä½œï¼Œåè¾¹ä¼ åŒ…çš„æ—¶å€™ä¼šæœ‰ 401 çš„é”™è¯¯ã€‚

![](http://t.eryajf.net/imgs/2022/09/8f676bc6ea80df5e.png)

## 3ï¼Œå®è·µ

ä»¥ä¸Šå‡†å¤‡å·¥ä½œå®Œæˆä¹‹åï¼Œå°±å¯ä»¥è¿›å…¥ä¼ åŒ…çš„å®è·µäº†ã€‚

é¦–å…ˆåˆ›å»ºä¸€ä¸ªç©ºçš„æµ‹è¯•åŒ…ï¼š

```sh
$ mkdir eryajf-test && cd eryajf-test
$ npm init -y && touch index.js
```

æ¥ç€ç™»é™†è®¤è¯åˆ°ç§æœï¼š

```sh
$ npm login --registry=http://192.168.31.68:8931/repository/npm-local/
Username: npm
Password:
Email: (this IS public) npm@eryajf.net
Logged in as npm on http://192.168.31.68:8931/repository/npm-local/.
```

ç„¶åæ‰§è¡Œä¸Šä¼ ï¼š

```sh
$ npm publish --registry http://192.168.31.68:8931/repository/npm-local/
npm notice
npm notice ğŸ“¦  eryajf-test@1.0.0
npm notice === Tarball Contents ===
npm notice 0    index.js
npm notice 225B package.json
npm notice === Tarball Details ===
npm notice name:          eryajf-test
npm notice version:       1.0.0
npm notice package size:  278 B
npm notice unpacked size: 225 B
npm notice shasum:        179052169d980f939dc5051bac456ed6b8f3d217
npm notice integrity:     sha512-XcOCpbgz9deAK[...]/5mKTv7o5d8Xg==
npm notice total files:   2
npm notice
+ eryajf-test@1.0.0
```

ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°å·²ç»ä¸Šä¼ æˆåŠŸäº†ï¼Œå»æµè§ˆå™¨å½“ä¸­æŸ¥çœ‹ï¼š

![](http://t.eryajf.net/imgs/2022/09/f6942b1961b8e329.png)

è¿™æ ·å°±æˆåŠŸå°†æœ¬åœ°çš„åŒ…ä¸Šä¼ åˆ°äº† `nexus` ç§æœå½“ä¸­ã€‚

## 4ï¼Œæµ‹è¯•

å½“æˆ‘ä»¬æŠŠåŒ…æˆåŠŸä¸Šä¼ ä¹‹åï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æµ‹è¯•åŒ…çš„ä¸‹è½½ï¼š

```sh
$ npm i -S eryajf-test@1.0.0 --registry=http://192.168.31.68:8931/repository/npm/
npm notice created a lockfile as package-lock.json. You should commit this file.
npm WARN npm-app2@1.0.3 No description
npm WARN npm-app2@1.0.3 No repository field.

+ eryajf-test@1.0.0
added 1 package in 0.551s
```

å¯ä»¥çœ‹åˆ°åŒ…å·²ç»å¯ä»¥é€šè¿‡ç§æœçš„ group æ­£å¸¸æ‹‰å–äº†ã€‚

## 5ï¼ŒæŠ¥é”™

- å¦‚æœé‡åˆ°å¦‚ä¸‹æŠ¥é”™ï¼š

    ```sh
    Unable to authenticate, need: BASIC realm="Sonatype Nexus Repository > Manager"
    ```

åŸå› æ˜¯æ²¡æœ‰å¯ç”¨ `npm Bearer Token Realm` å‚è€ƒä¸Šæ–‡è¿›è¡Œå¯ç”¨å³å¯ã€‚

- å¦‚æœé‡åˆ° 401 çš„æŠ¥é”™ï¼Œåˆ™å¤§å¤šæ˜¯è´¦å·å¯†ç è®¤è¯çš„é—®é¢˜ã€‚

## 6ï¼Œå‚è€ƒ

- [Publishing private NPM packages to Nexus](https://levelup.gitconnected.com/deploying-private-npm-packages-to-nexus-a16722cc8166)