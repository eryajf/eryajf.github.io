(window.webpackJsonp=window.webpackJsonp||[]).push([[221],{565:function(s,a,t){"use strict";t.r(a);var e=t(0),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("如果忘记了 root 密码，或者接手了一个不知道密码的 Gitlab，可以通过重置密码进行恢复。")]),s._v(" "),a("p",[s._v("登录到 Gitlab 服务器，执行如下命令：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("gitlab-rails console production\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("如果此时有报错：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("Traceback "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("most recent call last"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(": from bin/rails:4:in "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("main"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("'\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(": from bin/rails:4:in "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("require"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n    6: from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/commands.rb:18:in `<top (required)>'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/command.rb:46:in "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("invoke'\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/command/base.rb:69:in "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("perform"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n    3: from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("invoke_command'\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("run"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n/opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/commands/console/console_command.rb:95:in `perform'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" wrong number of arguments "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("given "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", expected "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ArgumentError"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(": from bin/rails:4:in "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("main"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("'\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(": from bin/rails:4:in "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("require"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n    7: from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/commands.rb:18:in `<top (required)>'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/command.rb:46:in "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("invoke'\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/railties-6.0.2/lib/rails/command/base.rb:69:in "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("perform"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n    4: from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("invoke_command'\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(": from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:20:in "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("run"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\n    1: from /opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:34:in `rescue in run'")]),s._v("\n/opt/gitlab/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:506:in `handle_argument_error': ERROR: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rails console"')]),s._v(" was called with arguments "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"production"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Thor::InvocationError"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nUsage: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rails console [options]"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[a("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/2afb7898edfbc2d9.jpg",alt:"img"}})]),s._v(" "),a("p",[s._v("则可能是 Gitlab 版本不一样，然后参数方式不一样，需要用如下方式：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("gitlab-rails console "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" production\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("接着查询一下用户：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" User.where"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username:"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".first\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#<User id:1 @root>")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("然后修改密码：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" user.password "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"11111111"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("然后保存：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" user.save"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nEnqueued ActionMailer::DeliveryJob "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Job ID: 1f015e02-34bc-4b26-8e37-3101937b7ce1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to Sidekiq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mailers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" with arguments: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DeviseMailer"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password_change"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"deliver_now"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#<GlobalID:0x00007fa6b83b1378 @uri=#<URI::GID gid://gitlab/User/1>>")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("保存之后，可以使用如上密码 test 进行登陆，登陆之后，记得更改密码！")])])}),[],!1,null,null,null);a.default=r.exports}}]);