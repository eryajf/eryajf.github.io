(window.webpackJsonp=window.webpackJsonp||[]).push([[190],{535:function(a,e,s){"use strict";s.r(e);var t=s(0),r=Object(t.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h2",{attrs:{id:"_1-查看磁盘占用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-查看磁盘占用"}},[a._v("#")]),a._v(" 1，查看磁盘占用")]),a._v(" "),e("p",[e("strong",[a._v("docker system df")]),a._v(" 命令，类似于 "),e("strong",[a._v("Linux")]),a._v("上的 "),e("strong",[a._v("df")]),a._v(" 命令，用于查看 "),e("strong",[a._v("Docker")]),a._v(" 的磁盘使用情况：")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("docker system df\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("strong",[a._v("TYPE")]),a._v("列出了 "),e("strong",[a._v("Docker")]),a._v(" 使用磁盘的 "),e("strong",[a._v("4")]),a._v(" 种类型：")]),a._v(" "),e("ul",[e("li",[e("strong",[a._v("Images")]),a._v(" ：所有镜像占用的空间，包括拉取下来的镜像，和本地构建的。")]),a._v(" "),e("li",[e("strong",[a._v("Containers")]),a._v(" ：运行的容器占用的空间，表示每个容器的读写层的空间。")]),a._v(" "),e("li",[e("strong",[a._v("Local Volumes")]),a._v(" ：容器挂载本地数据卷的空间。")]),a._v(" "),e("li",[e("strong",[a._v("Build Cache")]),a._v(" ：镜像构建过程中产生的缓存空间（只有在使用 "),e("strong",[a._v("BuildKit")]),a._v(" 时才有，"),e("strong",[a._v("Docker 18.09")]),a._v(" 以后可用）。")])]),a._v(" "),e("p",[a._v("最后的 "),e("strong",[a._v("RECLAIMABLE")]),a._v(" 是可回收大小。")]),a._v(" "),e("ul",[e("li",[e("strong",[a._v("docker system prune")]),a._v(" : 可以用于清理磁盘，删除关闭的容器、无用的数据卷和网络，以及 "),e("strong",[a._v("dangling")]),a._v(" 镜像（即无 "),e("strong",[a._v("tag")]),a._v(" 的镜像）。")]),a._v(" "),e("li",[e("strong",[a._v("docker system prune -a")]),a._v(" : 清理得更加彻底，可以将没有容器使用 "),e("strong",[a._v("Docker")]),a._v("镜像都删掉。\n注意，这两个命令会把你暂时关闭的容器，以及暂时没有用到的 "),e("strong",[a._v("Docker")]),a._v(" 镜像都删掉了。")])]),a._v(" "),e("p",[e("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/3714334f8a08107e.jpg",alt:"eb0053333dd237a83651ec97816cae17"}})]),a._v(" "),e("h2",{attrs:{id:"_2-清理镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-清理镜像"}},[a._v("#")]),a._v(" 2，清理镜像")]),a._v(" "),e("h3",{attrs:{id:"_1-介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-介绍"}},[a._v("#")]),a._v(" 1，介绍")]),a._v(" "),e("p",[a._v("使用 "),e("code",[a._v("docker image prune")]),a._v("可以 删除未使用的映像，注意"),e("a",{attrs:{href:"https://docs.docker.com/engine/api/v1.21/",target:"_blank",rel:"noopener noreferrer"}},[a._v("API 1.21+"),e("OutboundLink")],1),a._v("要使用此命令，客户端和守护进程 API 都必须至少是 "),e("a",{attrs:{href:"https://docs.docker.com/engine/api/v1.21/",target:"_blank",rel:"noopener noreferrer"}},[a._v("1.21"),e("OutboundLink")],1),a._v(" 。")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" image prune "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h")]),a._v("\nFlag shorthand "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h")]),a._v(" has been deprecated, please use "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--help")]),a._v("\n\nUsage:  "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" image prune "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("OPTIONS"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\nRemove unused images\n\nOptions:\n  -a, "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--all")]),a._v("             Remove all unused images, not just dangling ones 删除所有未使用的映像，而不仅仅是悬空映像\n      "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--filter")]),a._v(" filter   Provide filter values "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e.g. "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("'until=<timestamp>'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" 提供过滤值（例如'until "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("“）\n  -f, "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--force")]),a._v("           Do not prompt "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" confirmation 不要提示确认\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br")])]),e("h3",{attrs:{id:"_2-删除所有悬空镜像。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-删除所有悬空镜像。"}},[a._v("#")]),a._v(" 2，删除所有悬空镜像。")]),a._v(" "),e("p",[a._v("删除所有悬空映像。如果"),e("code",[a._v("-a")]),a._v("指定，还将删除任何容器未引用的所有映像。")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" image prune "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v("\nWARNING"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("!")]),a._v(" This will remove all images without at least one container associated to them.\nAre you sure you want to continue? "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("y/N"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" y\nDeleted Images:\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br")])]),e("div",{staticClass:"custom-block note"},[e("p",{staticClass:"custom-block-title"},[a._v("申明")]),a._v(" "),e("p",[e("strong",[a._v("原创文章"),e("Badge",{attrs:{text:"eryajf"}}),a._v("，未经授权，严禁转载，侵权必究！此乃文中随机水印，敬请读者谅解。")],1)]),a._v(" "),e("div",{staticClass:"custom-block right"},[e("p",[a._v("Copyright "),e("a",{attrs:{href:"https://wiki.eryajf.net",target:"_blank",rel:"noopener noreferrer"}},[a._v("二丫讲梵"),e("OutboundLink")],1),a._v(" 版权所有")])])]),a._v(" "),e("h3",{attrs:{id:"_3-过滤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-过滤"}},[a._v("#")]),a._v(" 3，过滤")]),a._v(" "),e("p",[a._v("过滤标志（"),e("code",[a._v("--filter")]),a._v("）格式为"),e("code",[a._v('"key = value"')]),a._v("。如果有多个过滤器，则传递多个标志（例如"),e("code",[a._v('--filter "foo=bar" --filter "bif=baz"')]),a._v("）")]),a._v(" "),e("p",[a._v("目前支持的过滤器是：")]),a._v(" "),e("ul",[e("li",[a._v("until（"),e("code",[a._v("<timestamp>")]),a._v("） - 仅删除在给定时间戳之前创建的映像")]),a._v(" "),e("li",[a._v("标签（"),e("code",[a._v("label=<key>")]),a._v("，"),e("code",[a._v("label=<key>=<value>")]),a._v("，"),e("code",[a._v("label!=<key>")]),a._v("，或"),e("code",[a._v("label!=<key>=<value>")]),a._v("） -仅删除与映像（或没有，如果"),e("code",[a._v("label!=...")]),a._v("被使用）指定的标签。")])]),a._v(" "),e("p",[a._v("该"),e("code",[a._v("until")]),a._v("过滤器可以是 Unix 的时间戳，日期格式的时间戳，或持续时间字符串（例如，去"),e("code",[a._v("10m")]),a._v("，"),e("code",[a._v("1h30m")]),a._v("）计算相对于守护机器的时间。支持的格式为日期格式时间戳包括 RFC3339Nano，RFC3339， ，"),e("code",[a._v("2006-01-02T15:04:05")]),a._v("，"),e("code",[a._v("2006-01-02T15:04:05.999999999")]),a._v("，"),e("code",[a._v("2006-01-02Z07:00")]),a._v("和"),e("code",[a._v("2006-01-02")]),a._v("。如果在时间戳结束时未提供 a "),e("code",[a._v("Z")]),a._v("或 "),e("code",[a._v("+-00:00")]),a._v("时区偏移，则将使用守护程序上的本地时区。提供 Unix 时间戳时输入秒[.nanoseconds]，其中秒是自 1970 年 1 月 1 日（午夜 UTC / GMT）以来经过的秒数，不计算闰秒（也称为 Unix 纪元或 Unix 时间）和可选项。纳秒字段是一秒的一小部分，不超过九位数。")]),a._v(" "),e("p",[a._v("的"),e("code",[a._v("label")]),a._v("过滤器接受两种格式。一个是"),e("code",[a._v("label=...")]),a._v("（"),e("code",[a._v("label=<key>")]),a._v("或"),e("code",[a._v("label=<key>=<value>")]),a._v("），它删除具有指定标签的映像。另一种格式是"),e("code",[a._v("label!=...")]),a._v("（"),e("code",[a._v("label!=<key>")]),a._v("或"),e("code",[a._v("label!=<key>=<value>")]),a._v("），它删除没有指定标签的映像。")]),a._v(" "),e("blockquote",[e("p",[e("strong",[a._v("预测将被删除的内容")])]),a._v(" "),e("p",[a._v("如果使用正过滤（测试标签是否存在或标签是否具有特定值），则可以使用"),e("code",[a._v("docker image ls")]),a._v("相同的过滤语法查看哪些映像与过滤器匹配。")]),a._v(" "),e("p",[a._v("但是，如果使用的是负过滤（测试对于不存在标签的或标签并"),e("em",[a._v("不")]),a._v("具有特定的值），这种类型的滤波器的不与工作"),e("code",[a._v("docker image ls")]),a._v("所以不能容易地预测哪些映像将被移除。此外，即使您正在使用，确认提示"),e("code",[a._v("docker image prune")]),a._v(" 始终会警告"),e("em",[a._v("所有")]),a._v("悬空映像将被删除 "),e("code",[a._v("--filter")]),a._v("。")])]),a._v(" "),e("p",[a._v("以下删除之前创建的映像"),e("code",[a._v("2021-01-01T00:00:00")]),a._v("。")]),a._v(" "),e("p",[a._v("查看：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" images "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--format")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("'table {{.Repository}}\\t{{.Tag}}\\t{{.ID}}\\t{{.CreatedAt}}\\t{{.Size}}'")]),a._v("\nREPOSITORY                                        TAG       IMAGE ID       CREATED AT                      SIZE\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("test")]),a._v("                                              latest    65f677cc947a   "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2021")]),a._v("-08-19 "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(":38:05 +0800 CST   445MB\nregistry.cn-hangzhou.aliyuncs.com/eryajf/centos   "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("7.8")]),a._v("       5ea7c3a67505   "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2020")]),a._v("-11-01 "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("18")]),a._v(":32:46 +0800 CST   475MB\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br")])]),e("p",[a._v("执行删除：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" image prune "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--force")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--filter")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"until=2021-01-01T00:00:00"')]),a._v("\nDeleted Images:\nuntagged: registry.cn-hangzhou.aliyuncs.com/eryajf/centos:7.8\nuntagged: registry.cn-hangzhou.aliyuncs.com/eryajf/centos@sha256:f7c413edcad7a3389e079cf04b4cddb46c96d67d29bf8c0d48dbd1ceeee2b474\ndeleted: sha256:5ea7c3a675055762552ad50b6f293bb050bdee188da3a2c37c61be90450f5987\ndeleted: sha256:c8279b704e4fb851f28a3fe2f02365df13bed3b6cc9b1fae6b2c50d562b04cec\ndeleted: sha256:e5a0eda56319769809257786837e4478e778aba54cdac72a468a8ac053637ca4\ndeleted: sha256:da34d2fe9e29af7b5ad6447089b19c2d0c7aa11d79641ca25e3de88a851706c7\ndeleted: sha256:613be09ab3c0860a5216936f412f09927947012f86bfa89b263dfa087a725f81\n\nTotal reclaimed space: "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("475")]),a._v(".2MB\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br")])]),e("p",[a._v("可以看到在这个时间点之前的 centos 镜像被删除了。如果这个镜像在占用状态，则不会删除。查看验证：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" images "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--format")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("'table {{.Repository}}\\t{{.Tag}}\\t{{.ID}}\\t{{.CreatedAt}}\\t{{.Size}}'")]),a._v("\nREPOSITORY   TAG       IMAGE ID       CREATED AT                      SIZE\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("test")]),a._v("         latest    65f677cc947a   "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2021")]),a._v("-08-19 "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(":38:05 +0800 CST   445MB\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br")])]),e("p",[e("strong",[e("code",[a._v("其他一些用法")])]),a._v("：")]),a._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[a._v("删除超过 10 天"),e("code",[a._v("240h")]),a._v("前创建的映像：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" image prune "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--force")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--filter")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"until=240h"')]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])])]),a._v(" "),e("li",[e("p",[a._v("使用标签删除映像"),e("code",[a._v("deprecated")]),a._v("：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" image prune "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--filter")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"label=deprecated"')]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])])]),a._v(" "),e("li",[e("p",[a._v("删除标签"),e("code",[a._v("maintainer")]),a._v("设置为的映像"),e("code",[a._v("john")]),a._v("：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" image prune "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--filter")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"label=maintainer=john"')]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])])]),a._v(" "),e("li",[e("p",[a._v("删除没有"),e("code",[a._v("maintainer")]),a._v("标签的映像：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" image prune "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--filter")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"label!=maintainer"')]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])])]),a._v(" "),e("li",[e("p",[a._v("删除维护者标签未设置为的映像"),e("code",[a._v("john")]),a._v("：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" image prune "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--filter")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"label!=maintainer=john"')]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])])])])]),a._v(" "),e("p",[e("strong",[a._v("注意")]),a._v("：在"),e("code",[a._v("prune")]),a._v("删除任何内容之前，系统会提示您进行确认，但不会显示可能删除的内容列表。此外，"),e("code",[a._v("docker image ls")]),a._v("不支持负过滤，因此很难预测实际将删除哪些映像。")]),a._v(" "),e("h2",{attrs:{id:"_3-定义容器日志大小"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-定义容器日志大小"}},[a._v("#")]),a._v(" 3，定义容器日志大小")]),a._v(" "),e("p",[a._v("在 docker 环境部署之后，我们可以直接通过配置文件参数来定义单个容器日志的大小，在/etc/docker/daemon.json 添加如下配置后重启 docker：")]),a._v(" "),e("div",{staticClass:"language-json line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"log-opts"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"max-size"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"300M"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"max-file"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"3"')]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"data-root"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/data/docker/docker-data/"')]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br")])]),e("p",[e("strong",[a._v("注意：已存在的容器需要删除重建后才可以生效，因此尽量在 docker 投入生产之前进行配置。")])]),a._v(" "),e("blockquote",[e("p",[a._v("参数说明：max-size 指定日志文件最大空间，max-file 指定日志滚动的次数，以上配置单个容器最大日志为 900M。data-root 指定 docker 数据目录。")])])])}),[],!1,null,null,null);e.default=r.exports}}]);