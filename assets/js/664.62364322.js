(window.webpackJsonp=window.webpackJsonp||[]).push([[664],{1006:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目"}},[t._v("#")]),t._v(" 项目")]),t._v(" "),s("div",{staticClass:"cardListContainer"},[s("div",{staticClass:"card-list"},[s("a",{staticClass:"card-item row-1",staticStyle:{"background-color":"#0074ff","--randomColor":"#0074ff",color:"#fff"},attrs:{href:"https://github.com/eryajf/chatgpt-wecom",target:"_blank"}},[s("img",{staticClass:"no-zoom",attrs:{src:"https://avatars2.githubusercontent.com/u/416130?s=460&u=8753e86600e300a9811cdc539aa158deec2e2724&v=4"}}),t._v(" "),s("div",[s("p",{staticClass:"name"},[t._v("chatgpt-wecom")]),t._v(" "),s("p",{staticClass:"desc"},[t._v("openldap Controller")])])])]),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chatgpt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("wecom\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("desc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" openldap Controller\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("avatar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" https"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//avatars2.githubusercontent.com/u/416130"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),t._v("s=460"),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&u=8753e86600e300a9811cdc539aa158deec2e2724&v=4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可选")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("link")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" https"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//github.com/eryajf/chatgpt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("wecom "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可选")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("bgColor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#0074ff"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可选，默认var(--bodyBg)。颜色值有#号时请添加单引号")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("textColor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#fff"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可选，默认var(--textColor)")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])])]),s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),s("p",[t._v("本项目可以助你将 GPT 机器人集成到企微应用当中。当前默认模型为"),s("code",[t._v("gpt-3.5")]),t._v("，支持"),s("code",[t._v("gpt-4")]),t._v("，同时支持 Azure-OpenAI。")]),t._v(" "),s("blockquote",[s("ul",[s("li",[s("code",[t._v("📢 注意")]),t._v("：当下部署以及配置流程都已非常成熟，文档和 issue 中基本都覆盖到了，因此不再回答任何项目安装部署与配置使用上的问题，如果完全不懂，可考虑通过 "),s("strong",[s("a",{attrs:{href:"mailto:eryajf@163.com"}},[t._v("邮箱")])]),t._v(" 联系我进行付费的技术支持。")])])]),t._v(" "),s("p",[t._v("🥳 "),s("strong",[t._v("欢迎关注我的其他开源项目：")])]),t._v(" "),s("blockquote",[s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/eryajf/go-ldap-admin",target:"_blank",rel:"noopener noreferrer"}},[t._v("Go-Ldap-Admin"),s("OutboundLink")],1),t._v("：🌉 基于 Go+Vue 实现的 openLDAP 后台管理项目。")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/eryajf/learning-weekly",target:"_blank",rel:"noopener noreferrer"}},[t._v("learning-weekly"),s("OutboundLink")],1),t._v("：📝 周刊内容以运维技术和 Go 语言周边为主，辅以 GitHub 上优秀项目或他人优秀经验。")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/eryajf/HowToStartOpenSource",target:"_blank",rel:"noopener noreferrer"}},[t._v("HowToStartOpenSource"),s("OutboundLink")],1),t._v("：🌈 GitHub 开源项目维护协同指南。")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/eryajf/read-list",target:"_blank",rel:"noopener noreferrer"}},[t._v("read-list"),s("OutboundLink")],1),t._v("：📖 优质内容订阅，阅读方为根本")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/eryajf/awesome-github-profile-readme-chinese",target:"_blank",rel:"noopener noreferrer"}},[t._v("awesome-github-profile-readme-chinese"),s("OutboundLink")],1),t._v("：🦩 优秀的中文区个人主页搜集")])])]),t._v(" "),s("p",[t._v("🚜 我还创建了一个项目 "),s("strong",[s("a",{attrs:{href:"https://github.com/eryajf/awesome-chatgpt-answer",target:"_blank",rel:"noopener noreferrer"}},[t._v("awesome-chatgpt-answer"),s("OutboundLink")],1)]),t._v(" ：记录那些问得好，答得妙的时刻，欢迎提交你与 ChatGPT 交互过程中遇到的那些精妙对话。")]),t._v(" "),s("p",[t._v("⚗️ openai 官方提供了一个 "),s("strong",[s("a",{attrs:{href:"https://status.openai.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("状态页"),s("OutboundLink")],1)]),t._v(" 来呈现当前 openAI 服务的状态，同时如果有问题发布公告也会在这个页面，如果你感觉它有问题了，可以在这个页面看看。")]),t._v(" "),s("h2",{attrs:{id:"功能介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#功能介绍"}},[t._v("#")]),t._v(" 功能介绍")]),t._v(" "),s("ul",[s("li",[t._v("[x] 🚀 帮助菜单：通过发送 "),s("code",[t._v("帮助")]),t._v(" 将看到帮助列表")]),t._v(" "),s("li",[t._v("[x] 🙋 单聊模式：每次对话都是一次新的对话，没有历史聊天上下文联系")]),t._v(" "),s("li",[t._v("[x] 🗣 串聊模式：带上下文理解的对话模式")]),t._v(" "),s("li",[t._v("[x] 🎭 角色扮演：支持场景模式，通过 "),s("code",[t._v("#周报")]),t._v(" 的方式触发内置 prompt 模板")]),t._v(" "),s("li",[t._v("[x] 🧑‍💻 频率限制：通过配置指定，自定义单个用户单日最大对话次数")]),t._v(" "),s("li",[t._v("[x] 🔗 自定义 api 域名：通过配置指定，解决国内服务器无法直接访问 openai 的问题")]),t._v(" "),s("li",[t._v("[x] 🪜 添加代理：通过配置指定，通过给应用注入代理解决国内服务器无法访问的问题")]),t._v(" "),s("li",[t._v("[x] 👐 默认模式：支持自定义默认的聊天模式，通过配置化指定")]),t._v(" "),s("li",[t._v("[x] 👹 白名单机制：通过配置指定，支持指定群组名称和用户名称作为白名单，从而实现可控范围与机器人对话")]),t._v(" "),s("li",[t._v("[x] 💂‍♀️ 管理员机制：通过配置指定管理员，部分敏感操作，以及一些应用配置，管理员有权限进行操作")]),t._v(" "),s("li",[t._v("[x] ㊙️ 敏感词过滤：通过配置指定敏感词，提问时触发，则不允许提问，回答的内容中触发，则以 🚫 代替")]),t._v(" "),s("li",[t._v("[ ] 🎨 图片生成：通过发送 "),s("code",[t._v("#图片")]),t._v("关键字开头的内容进行生成图片")]),t._v(" "),s("li",[t._v("[ ] 📝 查询对话：通过发送"),s("code",[t._v("#查对话 username:xxx")]),t._v("查询 xxx 的对话历史，可在线预览，可下载到本地")])]),t._v(" "),s("h2",{attrs:{id:"使用前提"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用前提"}},[t._v("#")]),t._v(" 使用前提")]),t._v(" "),s("ul",[s("li",[t._v("有 Openai 账号，并且创建好"),s("code",[t._v("api_key")]),t._v("，关于这个的申请创建，这里不过多赘述。")]),t._v(" "),s("li",[t._v("在企微开发者后台创建应用，需要如下五个配置信息：\n"),s("ul",[s("li",[s("code",[t._v("corp_id：")]),t._v("企业 ID")]),t._v(" "),s("li",[s("code",[t._v("agent_id:")]),t._v(" 应用 ID")]),t._v(" "),s("li",[s("code",[t._v("agent_secret:")]),t._v(" 应用秘钥")]),t._v(" "),s("li",[s("code",[t._v("receive_msg_token:")]),t._v(" API 接收消息的 token")]),t._v(" "),s("li",[s("code",[t._v("receive_msg_key:")]),t._v(" API 接收消息的 key")])])])]),t._v(" "),s("p",[t._v("接下来跟随如下教程，保你一次配置成功。")]),t._v(" "),s("h2",{attrs:{id:"使用教程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用教程"}},[t._v("#")]),t._v(" 使用教程")]),t._v(" "),s("h3",{attrs:{id:"第一步-创建应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第一步-创建应用"}},[t._v("#")]),t._v(" 第一步，创建应用")]),t._v(" "),s("ol",[s("li",[s("p",[s("a",{attrs:{href:"https://work.weixin.qq.com/wework_admin/frame",target:"_blank",rel:"noopener noreferrer"}},[t._v("点我登陆"),s("OutboundLink")],1),t._v("企业微信管理后台。")]),t._v(" "),s("p",[t._v("此时点击我的企业可以获取到企业 ID"),s("code",[t._v("corp_id")]),t._v("。\n")]),s("details",[s("summary",[t._v("🖼 点我查看示例图")]),t._v(" "),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/eryajf/tu/img/image_20230702_210053.jpg"}})]),s("p")]),t._v(" "),s("li",[s("p",[t._v("点击应用，创建一个新的应用。")]),t._v(" "),s("details",[s("summary",[t._v("🖼 点我查看示例图")]),t._v(" "),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/eryajf/tu/img/image_20230702_210600.jpg"}})])]),t._v(" "),s("li",[s("p",[t._v("创建成功之后，能够获取到应用的"),s("code",[t._v("agent_id")]),t._v("与"),s("code",[t._v("agent_secret")]),t._v("。")]),t._v(" "),s("details",[s("summary",[t._v("🖼 点我查看示例图")]),t._v(" "),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/eryajf/tu/img/image_20230702_210807.jpg"}})])]),t._v(" "),s("li",[s("p",[t._v("点击接收消息的"),s("code",[t._v("设置 API 接收")]),t._v("，进入回调地址配置页面，点击两个随机获取，可以获得"),s("code",[t._v("receive_msg_token")]),t._v("与"),s("code",[t._v("receive_msg_key")]),t._v("。")]),t._v(" "),s("details",[s("summary",[t._v("🖼 点我查看示例图")]),t._v(" "),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/eryajf/tu/img/image_20230702_211253.jpg"}})])])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("📢 注意：")]),t._v("此时点击保存会提示 "),s("code",[t._v("openapi回调地址请求不通过")]),t._v("，是因为保存配置的时候企微会向服务发送请求进行校验。所以此时这个页面先放这儿，去部署应用。应用部署起来之后，再回来保存配置就能成功了。")])]),t._v(" "),s("h3",{attrs:{id:"第二步-部署项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第二步-部署项目"}},[t._v("#")]),t._v(" 第二步，部署项目")]),t._v(" "),s("h4",{attrs:{id:"docker-部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker-部署"}},[t._v("#")]),t._v(" docker 部署")]),t._v(" "),s("p",[t._v("推荐你使用 docker-compose 快速运行本项目。")]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("chatgpt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chatgpt\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" registry.cn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("hangzhou.aliyuncs.com/eryajf/chatgpt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("wecom\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("LOG_LEVEL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"info"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 应用的日志级别 info/debug")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CORP_ID")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 企业ID")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("AGENT_ID")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 应用ID")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("AGENT_SECRET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 应用秘钥")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("RECEIVE_MSG_TOKEN")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# API接收消息的token")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("RECEIVE_MSG_KEY")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# API接收消息的key")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("APIKEY")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" xxxxxx "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 你的 api_key")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("BASE_URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果你使用官方的接口地址 https://api.openai.com，则留空即可，如果你想指定请求url的地址，可通过这个参数进行配置，注意需要带上 http 协议")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MODEL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gpt-3.5-turbo"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# 指定模型，默认为 gpt-3.5-turbo , 可选参数有： "gpt-4-32k-0613", "gpt-4-32k-0314", "gpt-4-32k", "gpt-4-0613", "gpt-4-0314", "gpt-4", "gpt-3.5-turbo-16k-0613", "gpt-3.5-turbo-16k", "gpt-3.5-turbo-0613", "gpt-3.5-turbo-0301", "gpt-3.5-turbo"，如果使用gpt-4，请确认自己是否有接口调用白名单，如果你是用的是azure，则该配置项可以留空或者直接忽略')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("SESSION_TIMEOUT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 会话超时时间,默认600秒,在会话时间内所有发送给机器人的信息会作为上下文")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MAX_QUESTION_LEN")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2048")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 最大问题长度，默认4096 token，正常情况默认值即可，如果使用gpt4-8k或gpt4-32k，可根据模型token上限修改。")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MAX_ANSWER_LEN")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2048")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 最大回答长度，默认4096 token，正常情况默认值即可，如果使用gpt4-8k或gpt4-32k，可根据模型token上限修改。")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MAX_TEXT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 最大文本 = 问题 + 回答, 接口限制，默认4096 token，正常情况默认值即可，如果使用gpt4-8k或gpt4-32k，可根据模型token上限修改。")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("HTTP_PROXY")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//host.docker.internal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15777")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定请求时使用的代理，如果为空，则不使用代理，注意需要带上 http 协议 或 socks5 协议")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("DEFAULT_MODE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"单聊"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定默认的对话模式，可根据实际需求进行自定义，如果不设置，默认为单聊，即无上下文关联的对话模式")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MAX_REQUEST")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 单人单日请求次数上限，默认为0，即不限制")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("PORT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8090")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定服务启动端口，默认为 8090，容器化部署时，不需要调整，一般在二进制宿主机部署时，遇到端口冲突时使用，如果run_mode为stream模式，则可以忽略该配置项")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("SERVICE_URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定服务的地址，就是当前服务可供外网访问的地址(或者直接理解为你配置在企微回调那里的地址)，用于生成图片时给企微做渲染")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 以下 ALLOW_USERS、DENY_USERS、VIP_USERS、ADMIN_USERS 配置中填写的是用户的userid")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# 比如 ["1301691029702722","1301691029702733"]，这个信息需要在企微管理后台的通讯录当中获取：hhttps://work.weixin.qq.com/wework_admin/frame#contacts')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 哪些用户可以进行对话，如果留空，则表示允许所有用户，如果要限制，则列表中写用户的userid")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ALLOW_USERS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 哪些用户可以进行对话，如果留空，则表示允许所有用户，如果要限制，则填写用户的userid")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("DENY_USERS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 哪些用户不可以进行对话，如果留空，则表示允许所有用户（如allow_user有配置，需满足相应条件），如果要限制，则列表中写用户的userid，黑名单优先级高于白名单")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("VIP_USERS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 哪些用户可以进行无限对话，如果留空，则表示只允许管理员（如max_request配置为0，则允许所有人），如果要针对指定VIP用户放开限制（如max_request配置不为0），则列表中写用户的userid")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ADMIN_USERS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定哪些人为此系统的管理员，如果留空，则表示没有人是管理员，如果要限制，则列表中写用户的userid")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("SENSITIVE_WORDS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 敏感词，提问时触发，则不允许提问，回答的内容中触发，则以 🚫 代替")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("AZURE_ON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"false"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否走Azure OpenAi API, 默认false ,如果为true，则需要配置下边的四个参数")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("AZURE_API_VERSION")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# Azure OpenAi API 版本，比如 "2023-03-15-preview"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("AZURE_RESOURCE_NAME")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# Azure OpenAi API 资源名称，比如 "openai"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("AZURE_DEPLOYMENT_NAME")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# Azure OpenAi API 部署名称，比如 "openai"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("AZURE_OPENAI_TOKEN")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Azure token")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("HELP")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Commands:\\n\\n=================================\\n\\n🙋 单聊 👉 单独聊天，缺省\\n\\n🗣 串聊 👉 带上下文聊天\\n\\n🔃 重置 👉 重置带上下文聊天\\n\\n🚀 帮助 👉 显示帮助信息\\n\\n=================================\\n\\n💪 Power By [eryajf/chatgpt-wecom](https://github.com/eryajf/chatgpt-wecom)"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 帮助信息，放在配置文件，可供自定义")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/app/data\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8000:8000"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" host.docker.internal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("host"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("gateway\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br")])]),s("p",[t._v("启动服务：")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" compose up "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h4",{attrs:{id:"二进制部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二进制部署"}},[t._v("#")]),t._v(" 二进制部署")]),t._v(" "),s("p",[t._v("如果你想通过命令行直接部署，可以直接下载 release 中的"),s("a",{attrs:{href:"https://github.com/eryajf/chatgpt-wecom/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("压缩包"),s("OutboundLink")],1),t._v(" ，请根据自己系统以及架构选择合适的压缩包，下载之后直接解压运行。")]),t._v(" "),s("p",[t._v("下载之后，在本地解压，即可看到可执行程序，与配置文件：")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" xf chatgpt-wecom-v0.0.4-darwin-arm64.tar.gz\n$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" chatgpt-wecom-v0.0.4-darwin-arm64\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" config.example.yml  config.yml\n$ ./chatgpt-wecom  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 直接运行")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果要守护在后台运行")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./chatgpt-wecom "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&>")]),t._v(" run.log "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tail")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" run.log\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("h3",{attrs:{id:"第三步-完善企微配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第三步-完善企微配置"}},[t._v("#")]),t._v(" 第三步，完善企微配置")]),t._v(" "),s("p",[t._v("此时服务如正常启动，可再回到企微管理后台的配置页面，尝试保存配置。如果服务正常，应该就能保存成功了，从服务日志当中，也可以看到企微发起的回调：")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("GIN"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2023")]),t._v("/07/02 - "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(":33:53 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("78.469")]),t._v("µs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("113.108")]),t._v(".92.100 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" GET      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ai/callback?msg_signature=fb23b8490965c74600dcb08b2e8b86d2aff664e4&timestamp=1688304833&nonce=1688533588&echostr=I5D3M3C%2Fk7AqBFRkACk8eHZAzt%2Fjx14IKk8wXUpA85xsQ2aU67lxEhgHVudLSrCWEPRFapeQ3EcYbni0Bqj01Q%3D%3D"')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("此时还需要将部署服务的 IP 加入到企微的白名单当中：")]),t._v(" "),s("details",[s("summary",[t._v("🖼 点我查看示例图")]),t._v(" "),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/eryajf/tu/img/image_20230702_213710.jpg"}})]),t._v(" "),s("p",[t._v("到这里配置步骤就完成了，可以尽情享用与智能机器人的交互了。")]),t._v(" "),s("p",[t._v("来到企业微信，点击工作台，然后可以看到我们添加的应用，点击应用，即可开始对话。")]),t._v(" "),s("details",[s("summary",[t._v("🖼 点我查看示例图")]),t._v(" "),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/eryajf/tu/img/image_20230702_213915.jpg"}})]),t._v(" "),s("h2",{attrs:{id:"配置文件说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置文件说明"}},[t._v("#")]),t._v(" 配置文件说明")]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 应用的日志级别，info or debug")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("log_level")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"info"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# openai api_key,如果你是用的是azure，则该配置项可以留空或者直接忽略")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("api_key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxxxxxxxx"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果你使用官方的接口地址 https://api.openai.com，则留空即可，如果你想指定请求url的地址，可通过这个参数进行配置，注意需要带上 http 协议，如果你是用的是azure，则该配置项可以留空或者直接忽略")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("base_url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# 指定模型，默认为 gpt-3.5-turbo , 可选参数有： "gpt-4-32k-0613", "gpt-4-32k-0314", "gpt-4-32k", "gpt-4-0613", "gpt-4-0314", "gpt-4", "gpt-3.5-turbo-16k-0613", "gpt-3.5-turbo-16k", "gpt-3.5-turbo-0613", "gpt-3.5-turbo-0301", "gpt-3.5-turbo"，如果使用gpt-4，请确认自己是否有接口调用白名单，如果你是用的是azure，则该配置项可以留空或者直接忽略')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("model")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gpt-3.5-turbo"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 会话超时时间,默认600秒,在会话时间内所有发送给机器人的信息会作为上下文")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("session_timeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 最大问题长度")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("max_question_len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2048")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 最大回答长度")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("max_answer_len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2048")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 最大上下文文本长度，通常该参数可设置为与模型Token限制相同")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("max_text")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定请求时使用的代理，如果为空，则不使用代理，注意需要带上 http 协议 或 socks5 协议，如果你是用的是azure，则该配置项可以留空或者直接忽略")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("http_proxy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定默认的对话模式，可根据实际需求进行自定义，如果不设置，默认为单聊，即无上下文关联的对话模式")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("default_mode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"单聊"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 单人单日请求次数上限，默认为0，即不限制")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("max_request")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定服务启动端口，默认为 8090，一般在二进制宿主机部署时，遇到端口冲突时使用，如果run_mode为stream模式，则可以忽略该配置项")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8090"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定服务的地址，就是当前服务可供外网访问的地址(或者直接理解为你配置在企微回调那里的地址)，用于生成图片时给企微做渲染，最新版本中将图片上传到了企微服务器，理论上你可以忽略该配置项，如果run_mode为stream模式，则可以忽略该配置项")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("service_url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://xxxxxx"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 以下 allow_users、deny_users、vip_users、admin_users 配置中填写的是用户的userid，outgoing机器人模式下不适用这些配置")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# 比如 ["1301691029702722","1301691029702733"]，这个信息需要在企微管理后台的通讯录当中获取：https://oa.dingtalk.com/contacts.htm#/contacts')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 哪些用户可以进行对话，如果留空，则表示允许所有用户，如果要限制，则列表中写用户的userid")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("allow_users")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 哪些用户不可以进行对话，如果留空，则表示允许所有用户（如allow_user有配置，需满足相应条件），如果要限制，则列表中写用户的userid，黑名单优先级高于白名单")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("deny_users")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 哪些用户可以进行无限对话，如果留空，则表示只允许管理员（如max_request配置为0，则允许所有人）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果要针对指定VIP用户放开限制（如max_request配置不为0），则列表中写用户的userid")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("vip_users")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定哪些人为此系统的管理员，如果留空，则表示没有人是管理员，如果要限制，则列表中写用户的userid")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("admin_users")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 敏感词，提问时触发，则不允许提问，回答的内容中触发，则以 🚫 代替")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("sensitive_words")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 帮助信息，放在配置文件，可供自定义")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("help")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Commands:\\n\\n=================================\\n\\n🙋 单聊 👉 单独聊天，缺省\\n\\n🗣 串聊 👉 带上下文聊天\\n\\n🔃 重置 👉 重置带上下文聊天\\n\\n🚀 帮助 👉 显示帮助信息\\n\\n=================================\\n\\n💪 Power By [eryajf/chatgpt-wecom](https://github.com/eryajf/chatgpt-wecom)"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Azure OpenAI 配置")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("azure_on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果是true，则会走azure的openai接口")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("azure_resource_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eryajf"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 对应你的主个性域名")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("azure_deployment_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gpt-35-turbo"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 对应的是 /deployments/ 后边跟着的这个值")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("azure_api_version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2023-03-15-preview"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 对应的是请求中的 api-version 后边的值")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("azure_openai_token")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxxxxxx"')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br")])]),s("h2",{attrs:{id:"常见问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[t._v("#")]),t._v(" 常见问题")]),t._v(" "),s("ul",[s("li",[t._v("企微只支持与应用一对一聊天，不支持群聊当中添加机器人的对话形式。")])]),t._v(" "),s("h2",{attrs:{id:"感谢"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#感谢"}},[t._v("#")]),t._v(" 感谢")]),t._v(" "),s("p",[t._v("这个项目能够成立，离不开这些开源项目：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/go-resty/resty",target:"_blank",rel:"noopener noreferrer"}},[t._v("go-resty/resty"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/patrickmn/go-cache",target:"_blank",rel:"noopener noreferrer"}},[t._v("patrickmn/go-cache"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/solywsh/chatgpt",target:"_blank",rel:"noopener noreferrer"}},[t._v("solywsh/chatgpt"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/gin-gonic/gin",target:"_blank",rel:"noopener noreferrer"}},[t._v("gin-gonic/gin"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/avast/retry-go",target:"_blank",rel:"noopener noreferrer"}},[t._v("avast/retry-go"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/sashabaranov/go-openai",target:"_blank",rel:"noopener noreferrer"}},[t._v("sashabaranov/go-openapi"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/charmbracelet/log",target:"_blank",rel:"noopener noreferrer"}},[t._v("charmbracelet/log"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/xen0n/go-workwx",target:"_blank",rel:"noopener noreferrer"}},[t._v("xen0n/go-workwx"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"赞赏"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#赞赏"}},[t._v("#")]),t._v(" 赞赏")]),t._v(" "),s("p",[t._v("如果觉得这个项目对你有帮助，你可以请作者"),s("a",{attrs:{href:"https://wiki.eryajf.net/reward/",target:"_blank",rel:"noopener noreferrer"}},[t._v("喝杯咖啡 ☕️"),s("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);