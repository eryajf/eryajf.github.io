(window.webpackJsonp=window.webpackJsonp||[]).push([[159],{504:function(a,s,e){"use strict";e.r(s);var t=e(0),r=Object(t.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("p",[a._v("针对实战使用进行讲解分析，不简简单单罗列命令参数了事。")]),a._v(" "),s("h2",{attrs:{id:"_1-构建使用。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-构建使用。"}},[a._v("#")]),a._v(" 1，构建使用。")]),a._v(" "),s("p",[a._v("静态文件部署，一般会用到此命令，完整命令如下：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rsync")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-avz")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--progress")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'ssh -p 34222'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--exclude")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Jenkinsfile'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--delete")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${WORKSPACE}")]),a._v("/  root@192.168.0.1:/data/test/\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[s("code",[a._v("-a")]),a._v("：--archive 归档模式，表示以递归方式传输文件，并保持所有文件属性，等于-rlptgoD")]),a._v(" "),s("li",[s("code",[a._v("-v")]),a._v("：输出详细过程")]),a._v(" "),s("li",[s("code",[a._v("-z")]),a._v("：对正在备份的文件进行压缩处理")]),a._v(" "),s("li",[s("code",[a._v("-r")]),a._v("：对子目录以递归模式处理")]),a._v(" "),s("li",[s("code",[a._v("-l")]),a._v("：保留软连接")]),a._v(" "),s("li",[s("code",[a._v("-p")]),a._v("：保持文件权限")]),a._v(" "),s("li",[s("code",[a._v("-t")]),a._v("：保持文件时间信息")]),a._v(" "),s("li",[s("code",[a._v("-g")]),a._v("：保持文件属组信息")]),a._v(" "),s("li",[s("code",[a._v("-o")]),a._v("：保持文件属主信息")]),a._v(" "),s("li",[s("code",[a._v("-D")]),a._v("：保持设备文件信息")]),a._v(" "),s("li",[s("code",[a._v("-e")]),a._v("： –rsh=command 指定使用 rsh、ssh 方式进行数据同步，一般使用 ssh")]),a._v(" "),s("li",[s("code",[a._v("exclude")]),a._v(": 排除某文件的同步，可以多个。")]),a._v(" "),s("li",[s("code",[a._v("--delete")]),a._v("：删除那些 DST 中 SRC 没有的文件。")]),a._v(" "),s("li",[s("code",[a._v("--progress")]),a._v("：显示每个文件传输的进度。知道是否有大型文件正在备份可能是有用的。")])]),a._v(" "),s("p",[s("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/e086da4217285fcf.jpg",alt:"5b5d835c55ef6201fc92907e92e2b610"}})]),a._v(" "),s("h2",{attrs:{id:"_2-其他注意。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-其他注意。"}},[a._v("#")]),a._v(" 2，其他注意。")]),a._v(" "),s("ul",[s("li",[s("p",[s("strong",[a._v("将 dirA 的所有文件同步到 dirB 内，并删除 dirB 内多余的文件")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rsync")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-avz")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--delete")]),a._v(" dirA/ dirB/\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("code",[a._v("源目录和目标目录结构一定要一致！！不能是dirA/* dirB/ 或者dirA/ dirB/* 或者 dirA/* dirB/*，如果不遵守，那么就不会删除。")])])]),a._v(" "),s("li",[s("p",[s("strong",[a._v("将 dirA 的所有文件同步到 dirB，但是在 dirB 内除了 fileB3.txt 这个文件不删之外，其他的都删除")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rsync")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-avz")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--delete")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--exclude")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"fileB3.txt"')]),a._v(" dirA/ dirB/\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])])]),a._v(" "),s("li",[s("p",[s("strong",[a._v("将 dirA 目录内的 fileA1.txt 和 fileA2.txt 不同步到 dirB 目录内")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rsync")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-avz")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--exclude")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"fileA1.txt"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--exclude")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"fileA2.txt"')]),a._v(" dirA/ dirB/\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])])]),a._v(" "),s("li",[s("p",[s("strong",[a._v("将 dirA 目录内的 fileA1.txt 和 fileA2.txt 不同步到 dirB 目录内，并且在 dirB 目录内删除多余的文件")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rsync")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-avz")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--exclude")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"fileA1.txt"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--exclude")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"fileA2.txt"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--delete")]),a._v(" dirA/ dirB/\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])])]),a._v(" "),s("li",[s("p",[s("strong",[a._v("将 dirA 目录内的 fileA1.txt 和 fileA2.txt 不同步到 dirB 目录内，并且在 dirB 目录内删除多余的文件，同时，如果 dirB 内有 fileA2.txt 和 fileA1.txt 这两个被排除同步的文件，仍然将其删除")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rsync")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-avz")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--exclude")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"fileA1.txt"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--exclude")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"fileA2.txt"')]),a._v(" --delete-excluded dirA/ dirB/\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])])])])])}),[],!1,null,null,null);s.default=r.exports}}]);