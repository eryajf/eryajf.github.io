(window.webpackJsonp=window.webpackJsonp||[]).push([[367],{708:function(t,s,n){"use strict";n.r(s);var a=n(0),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("我定义的通用的拉取代码片段如下：")]),t._v(" "),s("div",{staticClass:"language-groovy line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-groovy"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GitSCM'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" doGenerateSubmoduleConfigurations"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" submoduleCfg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" extensions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CloneOption'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" depth"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" noTags"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reference"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" shallow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    branches"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token interpolation-string"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("$")]),s("span",{pre:!0,attrs:{class:"token expression"}},[t._v("BRANCH")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("userRemoteConfigs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token interpolation-string"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token expression"}},[t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GIT_URL")]),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" credentialsId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token interpolation-string"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cicd-pass"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("对于其中一些参数知之不详，直到看到如下文章："),s("a",{attrs:{href:"https://www.jenkins.io/doc/pipeline/steps/workflow-scm-step/",target:"_blank",rel:"noopener noreferrer"}},[t._v("workflow-scm-step"),s("OutboundLink")],1),t._v("，这才激起我的研究欲望，本文将针对如上参数，参照官方文档一一说明。")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("userRemoteConfigs：指定 git 仓库相关的信息")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("url：String 类型，指定 git 存储库的 URL 或路径。以下是有效 git URL 的示例：")]),t._v(" "),s("ul",[s("li",[t._v("ssh://git@github.com/github/git.git")]),t._v(" "),s("li",[t._v("git@github.com:github/git.git (short notation for ssh protocol)")]),t._v(" "),s("li",[t._v("ssh://user@other.host.com/~/repos/R.git (to access the repos/R.git repository in the user's home directory)")]),t._v(" "),s("li",[t._v("https://github.com/github/git.git")])]),t._v(" "),s("p",[t._v("建议统一使用 https 风格，这样日常使用时便于跳转。")])]),t._v(" "),s("li",[s("p",[t._v("credentialsId：String 类型，用于"),s("strong",[t._v("检查")]),t._v("源的凭据，通常只需要写明凭据的 name 即可。")])]),t._v(" "),s("li",[s("p",[t._v("name：String 类型，存储库的 ID，一般情况下用不到。")])])])]),t._v(" "),s("li",[s("p",[t._v("branches：指定要构建的分支相关的标识信息。")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("name：String 类型，如果您想跟踪存储库中的特定分支，请指定分支。例如 master，一般配合参数传递过来。不过里边不仅仅支持分支名字的定义，还支持如下类型：")]),t._v(" "),s("ul",[s("li",[s("strong",[s("code",[t._v("<branchName>")])]),t._v("：指定要检出的分支，例如 master。")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("<tagName>")])]),t._v("：指定要检出的 tag，例如 v0.0.1。")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("<commitId>")])]),t._v("：检出指定的提交，例如："),s("code",[t._v("5062ac843f2b947733e6a3b105977056821bd352")]),t._v("，"),s("code",[t._v("5062ac84")]),t._v("。")])]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("需要注意的是")]),t._v("：如果使用 commitID 进行构建，而且是一个过去的 ID，那么 depth: 1 需要去掉，否则总是会报错。")])])])])]),t._v(" "),s("li",[s("p",[t._v("gitTool：String 类型，指定 git 命令的路径，通常情况下，git 都是系统全局可用的，因此此参数可忽略。")])]),t._v(" "),s("li",[s("p",[t._v("extensions：扩展为不同用途添加新行为或修改现有插件行为，帮助用户更精确地调整插件行为以满足使用需求。参数项比较多，挑一些常用的说明一下。")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("$class: 'CloneOption'")]),t._v("：用于定义 clone 时的一些参数配置。\n"),s("ul",[s("li",[t._v("depth：int 类型，设置浅克隆深度，通常设置为 1 用于加快拉取，如果想要常规 clone，则删除此配置项。")]),t._v(" "),s("li",[t._v("noTags：bool 类型，取消选择此选项可在没有标签的情况下执行克隆，从而在您只想访问 refspec 指定的内容时节省时间和磁盘空间。")]),t._v(" "),s("li",[t._v("reference：String 类型，指定包含存储库的文件夹，Git 将在克隆操作期间将其用作参考。如果文件夹在执行克隆的控制器或代理上不可用，则将忽略此选项。")]),t._v(" "),s("li",[t._v("shallow：bool 类型，执行浅克隆，这样 git 就不会下载项目的历史记录，可以节省时间和磁盘空间。")]),t._v(" "),s("li",[t._v("timeout：int 类型，指定克隆和获取操作的超时时间（以分钟为单位，默认值：10）。")])])]),t._v(" "),s("li",[s("code",[t._v("$class: 'CleanCheckout'")]),t._v("：通过删除所有未跟踪的文件和目录，包括在"),s("code",[t._v(".gitignore")]),t._v(". 它还会将所有"),s("em",[t._v("跟踪的")]),t._v("文件重置为其版本化状态。这确保工作区处于与您在全新的空目录中克隆和检出时相同的状态，并确保您的构建不受先前构建生成的文件的影响。\n"),s("ul",[s("li",[t._v("deleteUntrackedNestedRepositories：删除未跟踪的子模块和包含.git 目录的任何其他子目录。类型： boolean")])])])])])]),t._v(" "),s("p",[s("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/10/99cdb1fc4f89bf26.jpg",alt:""}})]),t._v(" "),s("p",[t._v("知其然也要知其所以然，才不会在日常使用过程中被其牵制，当我们掌握这些细节越多之后，自身的价值就总会在某些不起眼的时刻迸发出来。")])])}),[],!1,null,null,null);s.default=e.exports}}]);