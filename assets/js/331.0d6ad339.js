(window.webpackJsonp=window.webpackJsonp||[]).push([[331],{676:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"_1-前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-前言"}},[t._v("#")]),t._v(" 1，前言")]),t._v(" "),s("p",[t._v("报错！是运维工作中不可豁免的一个问题。\n出问题，就应是运维工作应该避免的问题。")]),t._v(" "),s("p",[t._v("我们有理由相信，运维的能力，就是解决问题的能力。")]),t._v(" "),s("p",[t._v("而有趣的是我们解决问题的能力的提升又有赖于问题的解决，如果平常连问题都无从解决，那么也毋谈能力的提升了。")]),t._v(" "),s("p",[t._v("我想到自己遇到问题的时各方求索无果的时候，一方面想骂一句网上的教程都是坑，但是到最后自己的答案还是需要去网上来找。事实就是如此荒唐。不知道别人提倡的理念是什么，总之我觉得，遇到问题，一定要去请教，如果自己死扣，浪费时间不说，还做了很多无用功，请教之后学会了，记住了，就变成自己的了。")]),t._v(" "),s("p",[t._v("鉴于此，个人打算专门开一篇文章收录 Jenkins 使用过程中遇到的报错，异常，问题等。")]),t._v(" "),s("p",[t._v("简单说明：")]),t._v(" "),s("h3",{attrs:{id:"_1-收集的问题皆是我所见到的-以及我所解决的。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-收集的问题皆是我所见到的-以及我所解决的。"}},[t._v("#")]),t._v(" 1，收集的问题皆是我所见到的，以及我所解决的。")]),t._v(" "),s("p",[t._v("说白了就是每个人遇到的问题可能不同，或者遇到同一个问题的原因也可能是不同的，那么我这里所给出的解决办法可能只适用于我所遇到的情况，不一定具有万能性。")]),t._v(" "),s("h3",{attrs:{id:"_2-我会尽量将问题重现-说明-解决。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-我会尽量将问题重现-说明-解决。"}},[t._v("#")]),t._v(" 2，我会尽量将问题重现，说明，解决。")]),t._v(" "),s("p",[t._v("我会尽自己能尽量将问题重现一下，把出现此问题的可能性给出来，解决的思路以及办法也都毫不保留的倾囊相述，如果那些地方是有毛病的，欢迎评论区指出，让此文章真正成为一个可以帮人解决燃眉之急的“及时雨”。")]),t._v(" "),s("h3",{attrs:{id:"_3-如果有问题-可与我联系。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-如果有问题-可与我联系。"}},[t._v("#")]),t._v(" 3，如果有问题，可与我联系。")]),t._v(" "),s("p",[t._v("每个人都是在不断学习当中成长的，我也一样，如果在某些地方有疑问，或者搞不懂，欢迎通过主页的 qq 或者微信与我联系。")]),t._v(" "),s("h3",{attrs:{id:"_4-本文会持续性更新。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-本文会持续性更新。"}},[t._v("#")]),t._v(" 4，本文会持续性更新。")]),t._v(" "),s("p",[t._v("本文将会在相当长的一段时间里，不断更新与补充，尽量将其完善成为一个问题解决小手册。")]),t._v(" "),s("p",[t._v("很早前，我每天都被深刻灌输以及践行“帮助别人，成就自己”的口号。现在，这句话仍旧被我传承发扬着。")]),t._v(" "),s("p",[t._v("技术人有一个很奇怪的癖好就是“敝帚自珍”（讽刺之意），总愿意把自己的那些或是很差的或是很好的东西保存，收藏，自用。这是一种很奇怪的癖好，一点也不好。")]),t._v(" "),s("p",[t._v("ok，接下来，开始表演。")]),t._v(" "),s("p",[t._v("表演之前仍旧先来个小福利缓解一下因为报错而受扰的心情。")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/1d8a70b1ce7ca866.jpg",alt:"image"}})]),t._v(" "),s("h2",{attrs:{id:"_2-忘记管理员密码怎么办。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-忘记管理员密码怎么办。"}},[t._v("#")]),t._v(" 2，忘记管理员密码怎么办。")]),t._v(" "),s("p",[t._v("平常我们都是通过普通用户来对 Jenkins 进行管理，配置，发布等操作，但是如果某天需要管理员的用户密码，而这个大家并不常用的密码，也就被遗忘到了九霄云外，这个时候该怎么办呢，有两种办法可以找回。")]),t._v(" "),s("p",[t._v("具体操作参考我的另外一篇，Jenkins 忘记管理员密码怎么办。"),s("a",{attrs:{href:"https://wiki.eryajf.net/pages/106.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jenkins 实战应用–Jenkins 忘记管理员密码怎么办"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("h2",{attrs:{id:"_3-配置-git-连接时报错怎么办。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置-git-连接时报错怎么办。"}},[t._v("#")]),t._v(" 3，配置 Git 连接时报错怎么办。")]),t._v(" "),s("p",[t._v("有不少人在刚开始入门 Jenkins 的时候都会遇到与 Git 连接的问题，其实这里的问题并不复杂，只不过对其两者之间的关系不大清晰，因此才觉得一头雾水。")]),t._v(" "),s("p",[t._v("报错内容无非如下两种：")]),t._v(" "),s("p",[t._v("1，URL 开头是 http 的报错。")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("Failed to connect to repository "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Command “git ls-remote "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-h")]),t._v(" http://192.168.96.23/root/testa.git HEAD” returned status code "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),t._v(":\nstdout:\nstderr: error: The requested URL returned error: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("401")]),t._v(" Unauthorized "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" accessing http://192.168.96.23/root/testa.git/info/refs\n\n\n\nfatal: HTTP request failed\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("p",[t._v("2，URL 开头是 git 的报错。")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("Failed to connect to repository "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Command “git ls-remote "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-h")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("git@192.168.96.23"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mailto:git@192.168.96.23"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":root/testa.git HEAD” returned status code "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),t._v(":\nstdout:\nstderr: Permission denied, please try again.\nPermission denied, please try again.\nPermission denied "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("publickey,gssapi-keyex,gssapi-with-mic,password"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".\nfatal: The remote end hung up unexpectedly\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("p",[t._v("如下图：")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/672c2177c697da17.jpg",alt:"image"}})]),t._v(" "),s("blockquote",[s("p",[t._v("如果你确确实实是第一次刚刚把主机初始化进入到 Jenkins，然后配置了一个项目，配置完 Git 连接就见红报错了。那么这个时候你应该检查一下，是不是你的主机没有安装"),s("code",[t._v("git的命令")]),t._v("。使用 yum -y install git 即可解决。")])]),t._v(" "),s("p",[t._v("之前有人在群里发过碰到这个错误怎么办，我当时因为理解不透，而且看到自己这边配置的地址是git@192.168.96.23:root/testa.git 一直是成功的，因此就帮人指导说你换成 git 开头的 URL 就好了，熟不知问题的症结压根就不在这里，而是因为没有配置秘钥认证才导致的见红（报错）。")]),t._v(" "),s("p",[t._v("不过即便不是哪个开头的问题，我也推荐使用 git 开头的 URL 作为项目链接填写在这里，因为下午看廖雪峰 Git 教程时看到其中有这么说：使用 https 除了速度慢以外，还有个最大的麻烦是每次推送都必须输入口令，但是在某些只开放 http 端口的公司内部就无法使用 ssh 协议而只能用 https。")]),t._v(" "),s("p",[t._v("因此，如果条件允许，那么我推荐使用 git 开头的 url，如果公司禁止 22 端口，那么再选择其他。")]),t._v(" "),s("p",[t._v("现在说回刚才的问题。其实解决起来也非常简单。")]),t._v(" "),s("p",[t._v("不过此处也话分两头。")]),t._v(" "),s("h3",{attrs:{id:"_1-如果填写的-url-是刚才的-http-开头的。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-如果填写的-url-是刚才的-http-开头的。"}},[t._v("#")]),t._v(" 1，如果填写的 url 是刚才的 http 开头的。")]),t._v(" "),s("p",[t._v("那么此时点击红色提示下边的 add 添加可以登录到 gitlab 上并且对项目有权限的用户。")]),t._v(" "),s("p",[t._v("如我刚搭建的 gitlab，账号还是默认的管理员 root，如下将账号密码填写进去，点击 add 添加。")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/9b2f4843dee5d39e.jpg",alt:"image"}})]),t._v(" "),s("p",[t._v("然后选择用户中，选中刚才添加的 root 账户。")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/f711a5ae41869138.jpg",alt:"image"}})]),t._v(" "),s("p",[t._v("此时就会发现，红色报错消失了，表明 Jenkins 与 gitlab 的连接通了。")]),t._v(" "),s("h3",{attrs:{id:"_2-如果刚刚填写的-url-是-git-开头的。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-如果刚刚填写的-url-是-git-开头的。"}},[t._v("#")]),t._v(" 2，如果刚刚填写的 url 是 git 开头的。")]),t._v(" "),s("p",[t._v("此时只用去到 Jenkins 服务器上，将其公钥放在 gitlab 的 ssh key 处，红色报错就消失了。")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ssh-keygen\t#一路回车\ncat /root/.ssh/id_rsa.pub  #复制下来\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[s("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/7a94dd11263c7a59.jpg",alt:"image"}})]),t._v(" "),s("p",[t._v("1，点击头像选中设置。")]),t._v(" "),s("p",[t._v("2，点击 ssh 秘钥栏。")]),t._v(" "),s("p",[t._v("3，在此处将刚才复制的秘钥拷贝进来。")]),t._v(" "),s("p",[t._v("再回到 Jenkins 当中查看，发现报错也消失了。一旦这种互信创建完成之后，基本上两者就默认对上号了。")]),t._v(" "),s("blockquote",[s("p",[t._v("如果配置完了之后还不成功，而且报 128 的错误码，那么应该是在第一次建立互信的时候需要输入一下 yes 的问题，去 Jenkins 主机上，手动建立一次与 gitlab 的连接即可（建立 ssh 的连接或者 git 的连接都可以）。")])]),t._v(" "),s("blockquote",[s("p",[t._v("其实上边刚才有两个地方的表述，是不严谨的，分别是 1，2 标题处我说当 url 的开头是什么什么，当时这么说只是为了让 ssh 与秘钥对应，http 与用户名对应而已，事实上，只要配置了其中一种互信方式，那么无论 url 的开头是 http 还是 git，都是可以连接的。")])]),t._v(" "),s("p",[t._v("补充：")]),t._v(" "),s("p",[t._v("如果刚才 add 账户的时候错了，该怎么办呢？")]),t._v(" "),s("p",[t._v("去到首页—>点击 Credentials 就能看到自己添加过的用户，并进行管理了。")]),t._v(" "),s("h2",{attrs:{id:"_4-部署失败之-error-couldn-t-find-any-revision-to-build-verify-the-repository-and-branch-configuration-for-this-job"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-部署失败之-error-couldn-t-find-any-revision-to-build-verify-the-repository-and-branch-configuration-for-this-job"}},[t._v("#")]),t._v(" 4，部署失败之 ERROR: Couldn’t find any revision to build. Verify the repository and branch configuration for this job")]),t._v(" "),s("p",[t._v("当我们开发人员来找到我们说，我刚刚构建失败啦。")]),t._v(" "),s("p",[t._v("然后你去看到底什么问题。")]),t._v(" "),s("p",[s("code",[t._v("ERROR: Couldn't find any revision to build. Verify the repository and branch configuration for this job.")])]),t._v(" "),s("p",[s("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/955e415f2a40cde9.jpg",alt:"image"}})]),t._v(" "),s("p",[t._v("看到这样的问题，那么基本可以断定，应该是他刚刚新建了一个分支，要进行测试构建，但是可能代码还"),s("code",[t._v("没有push")]),t._v("到远端代码库，而在构建的时候又填写了这个分支，那么 Jenkins 就会报错："),s("code",[t._v("ERROR: Couldn't find any revision to build. Verify the repository and branch configuration for this job.（找不到任何修订版本。 验证此作业的存储库和分支配置--谷歌翻译）")])]),t._v(" "),s("p",[t._v("就让他重新 push 之后在构建咯。这个问题可以通过构建一个不存在的分支进行复现测试。")]),t._v(" "),s("h2",{attrs:{id:"_5-部署之后代码没有改变的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-部署之后代码没有改变的问题"}},[t._v("#")]),t._v(" 5，部署之后代码没有改变的问题")]),t._v(" "),s("p",[t._v("最近两周新上项目较多，因此我与另外一位运维小伙伴两个人一起扛起了许多项目的交付与上线。")]),t._v(" "),s("p",[t._v("但是今天突然一个小伙伴跟我说，部署了之后发现代码没有变化。一开始我以为是 Jenkins 与 Gitlab 之间的问题，导致的代码更新问题。")]),t._v(" "),s("p",[t._v("后来跑到他身边，经过他那么一演示，我明白了。并根据经验解决了这次问题。")]),t._v(" "),s("p",[t._v("他给我演示的是原来代码里引用了某个类，现在呢，是把这个类给删除了，但是推了代码，重新发布，去看程序日志输出发现刚才删除的类，现在还在呢。")]),t._v(" "),s("p",[t._v("我就想应该是发布的时候没有清掉，估计就是 mvn 打包时候的问题啦，到 Jenkins 的配置里边一看，果然，只有正常打包的命令，而少了一个"),s("code",[t._v("clean")]),t._v("的参数，从而使得这个程序的打包命令只会一直往前打包，也就是说代码里有新的依赖等的他会解决加进来，但是如果删掉了某个类或者依赖，他则不会做任何动作。")]),t._v(" "),s("p",[t._v("加上 clean 的参数，事实上就是首先将其清空，然后再来依据代码里边的 pom 文件或者其他装载着依赖的文件进行打包构建。于是，问题就解决啦！")]),t._v(" "),s("p",[t._v("更新之后的打包命令如下：")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("mvn clean "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Dmaven.test.skip")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h2",{attrs:{id:"_6-jenkins-与-tomcat-在同一台部署完毕进程被-kill-的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-jenkins-与-tomcat-在同一台部署完毕进程被-kill-的问题"}},[t._v("#")]),t._v(" 6，Jenkins 与 tomcat 在同一台部署完毕进程被 kill 的问题")]),t._v(" "),s("p",[t._v("如果 Jenkins 与 tomcat 在同一台当中部署，这个时候部署项目的时候，发现部署完毕之后项目进程会被干掉。")]),t._v(" "),s("p",[t._v("问题过程大概是这样，当用户发起构建，系统当中会启动相应的进程进行构建任务，当构建任务完成之后，或者被人为中断之后，程序利用 ProcessTreeKiller，获取计算机上运行的所有进程及其环境变量的列表，并查找最初为构建作业的进程设置的环境变量，然后终止在其环境中具有该环境变量的每个作业。")]),t._v(" "),s("p",[t._v("解决思路：实现这一目标的一种便捷方法是更改 Jenkins 的 ProcessTreeKiller 正在寻找的环境变量 BUILD_ID，这将会让 Jenkins 认为您的守护进程不是由 Jenkins 构建生成的。")]),t._v(" "),s("p",[t._v("比如在执行 shell 当中添加如下变量即可：")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("BUILD_ID")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("dontKillMe\n注意：如果Jenkins Pipeline使用JENKINS_NODE_COOKIE而不是BUILD_ID。\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("参考：https://wiki.jenkins.io/display/JENKINS/ProcessTreeKiller")]),t._v(" "),s("h2",{attrs:{id:"_7-配置了-ldap-之后无法启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-配置了-ldap-之后无法启动"}},[t._v("#")]),t._v(" 7，配置了 ldap 之后无法启动")]),t._v(" "),s("p",[t._v("参看这里：https://www.58jb.com/html/jenkins_ldap_login_failure.html")]),t._v(" "),s("h2",{attrs:{id:"_8-项目连续构建第二次失败"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-项目连续构建第二次失败"}},[t._v("#")]),t._v(" 8，项目连续构建第二次失败")]),t._v(" "),s("p",[t._v("我们配置的新项目，第一次构建正常，在进行第二次构建的时候会报如下错误：")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("Fetching changes from the remote Git repository\nUsing shallow fetch with depth "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nERROR: Error fetching remote repo "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'origin'")]),t._v("\nhudson.plugins.git.GitException: Failed to fetch from https://gitlab.eryajf.net/service/niffler-go.git\n\tat hudson.plugins.git.GitSCM.fetchFrom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GitSCM.java:996"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat hudson.plugins.git.GitSCM.retrieveChanges"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GitSCM.java:1237"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat hudson.plugins.git.GitSCM.checkout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GitSCM.java:1297"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org.jenkinsci.plugins.workflow.steps.scm.SCMStep.checkout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SCMStep.java:125"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org.jenkinsci.plugins.workflow.steps.scm.SCMStep"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$StepExecutionImpl")]),t._v(".run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SCMStep.java:93"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org.jenkinsci.plugins.workflow.steps.scm.SCMStep"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$StepExecutionImpl")]),t._v(".run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SCMStep.java:80"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org.jenkinsci.plugins.workflow.steps.SynchronousNonBlockingStepExecution.lambda"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$start")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SynchronousNonBlockingStepExecution.java:47"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat java.util.concurrent.Executors"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$RunnableAdapter")]),t._v(".call"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Executors.java:511"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat java.util.concurrent.FutureTask.run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FutureTask.java:266"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ThreadPoolExecutor.java:1149"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat java.util.concurrent.ThreadPoolExecutor"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$Worker")]),t._v(".run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ThreadPoolExecutor.java:624"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat java.lang.Thread.run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Thread.java:748"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nCaused by: hudson.plugins.git.GitException: Command "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/usr/bin/git fetch --tags --progress --depth=1 https://gitlab.eryajf.net/service/niffler-go.git +refs/heads/*:refs/remotes/origin/*"')]),t._v(" returned status code "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),t._v(":\nstdout:\nstderr: fatal: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" fetch-pack: expected shallow list\nfatal: The remote end hung up unexpectedly\n\n\tat org.jenkinsci.plugins.gitclient.CliGitAPIImpl.launchCommandIn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CliGitAPIImpl.java:2450"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org.jenkinsci.plugins.gitclient.CliGitAPIImpl.launchCommandWithCredentials"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CliGitAPIImpl.java:2051"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org.jenkinsci.plugins.gitclient.CliGitAPIImpl.access"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$500")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CliGitAPIImpl.java:84"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org.jenkinsci.plugins.gitclient.CliGitAPIImpl"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(".execute"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CliGitAPIImpl.java:573"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org.jenkinsci.plugins.gitclient.RemoteGitImpl"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$CommandInvocationHandler")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$GitCommandMasterToSlaveCallable")]),t._v(".call"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RemoteGitImpl.java:161"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat org.jenkinsci.plugins.gitclient.RemoteGitImpl"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$CommandInvocationHandler")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$GitCommandMasterToSlaveCallable")]),t._v(".call"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RemoteGitImpl.java:154"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat hudson.remoting.UserRequest.perform"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UserRequest.java:211"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat hudson.remoting.UserRequest.perform"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UserRequest.java:54"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat hudson.remoting.Request"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$2")]),t._v(".run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Request.java:375"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat hudson.remoting.InterceptingExecutorService"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(".call"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("InterceptingExecutorService.java:73"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat java.util.concurrent.FutureTask.run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FutureTask.java:266"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ThreadPoolExecutor.java:1149"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat java.util.concurrent.ThreadPoolExecutor"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$Worker")]),t._v(".run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ThreadPoolExecutor.java:624"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tat hudson.remoting.Engine"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(".lambda"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$newThread")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Engine.java:118"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("more")]),t._v("\n\tSuppressed: hudson.remoting.Channel"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$CallSiteStackTrace")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Remote call to JNLP4-connect connection from "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.3")]),t._v(".9.144/10.3.9.144:46742\n\t\tat hudson.remoting.Channel.attachCallSiteStackTrace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Channel.java:1800"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat hudson.remoting.UserRequest"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ExceptionResponse")]),t._v(".retrieve"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UserRequest.java:357"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat hudson.remoting.Channel.call"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Channel.java:1001"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat org.jenkinsci.plugins.gitclient.RemoteGitImpl"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$CommandInvocationHandler")]),t._v(".execute"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RemoteGitImpl.java:146"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat sun.reflect.GeneratedMethodAccessor559.invoke"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Unknown Source"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat sun.reflect.DelegatingMethodAccessorImpl.invoke"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DelegatingMethodAccessorImpl.java:43"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat java.lang.reflect.Method.invoke"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Method.java:498"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat org.jenkinsci.plugins.gitclient.RemoteGitImpl"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$CommandInvocationHandler")]),t._v(".invoke"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RemoteGitImpl.java:132"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat com.sun.proxy."),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$Proxy92")]),t._v(".execute"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Unknown Source"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat hudson.plugins.git.GitSCM.fetchFrom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GitSCM.java:994"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat hudson.plugins.git.GitSCM.retrieveChanges"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GitSCM.java:1237"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat hudson.plugins.git.GitSCM.checkout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GitSCM.java:1297"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat org.jenkinsci.plugins.workflow.steps.scm.SCMStep.checkout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SCMStep.java:125"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat org.jenkinsci.plugins.workflow.steps.scm.SCMStep"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$StepExecutionImpl")]),t._v(".run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SCMStep.java:93"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat org.jenkinsci.plugins.workflow.steps.scm.SCMStep"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$StepExecutionImpl")]),t._v(".run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SCMStep.java:80"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat org.jenkinsci.plugins.workflow.steps.SynchronousNonBlockingStepExecution.lambda"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$start")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SynchronousNonBlockingStepExecution.java:47"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat java.util.concurrent.Executors"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$RunnableAdapter")]),t._v(".call"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Executors.java:511"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat java.util.concurrent.FutureTask.run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FutureTask.java:266"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat java.util.concurrent.ThreadPoolExecutor.runWorker"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ThreadPoolExecutor.java:1149"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\tat java.util.concurrent.ThreadPoolExecutor"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$Worker")]),t._v(".run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ThreadPoolExecutor.java:624"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("more")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br"),s("span",{staticClass:"line-number"},[t._v("49")]),s("br"),s("span",{staticClass:"line-number"},[t._v("50")]),s("br"),s("span",{staticClass:"line-number"},[t._v("51")]),s("br"),s("span",{staticClass:"line-number"},[t._v("52")]),s("br"),s("span",{staticClass:"line-number"},[t._v("53")]),s("br"),s("span",{staticClass:"line-number"},[t._v("54")]),s("br"),s("span",{staticClass:"line-number"},[t._v("55")]),s("br"),s("span",{staticClass:"line-number"},[t._v("56")]),s("br"),s("span",{staticClass:"line-number"},[t._v("57")]),s("br"),s("span",{staticClass:"line-number"},[t._v("58")]),s("br")])]),s("p",[t._v("这个错误在通过删除工作空间下的 "),s("code",[t._v(".git")]),t._v("目录之后再发布就正常了，但这并不是解决问题的办法，网上看了很多的资料，说啥的都有，有说 slave 的 jdk 不能用 openjdk 的，这个变更之后没有效果。")]),t._v(" "),s("p",[t._v("也有说是 git 命名版本太低的，说低版本的 git 对浅层克隆支持的不太好，这倒是有可能的，因为我们的确在拉代码的地方加了 "),s("code",[t._v("depth 1")]),t._v("的参数，于是乎，通过如下一顿操作，更换了 git 版本：")]),t._v(" "),s("p",[t._v("将如下内容写入到 "),s("code",[t._v("/etc/yum.repos.d/wandisco-git.repo")]),t._v(" :")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("wandisco-git"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Wandisco GIT Repository\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("baseurl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://opensource.wandisco.com/centos/7/git/"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$basearch")]),t._v("/\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("enabled")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("gpgcheck")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("gpgkey")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://opensource.wandisco.com/RPM-GPG-KEY-WANdisco\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("p",[t._v("导入：")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rpm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--import")]),t._v(" http://opensource.wandisco.com/RPM-GPG-KEY-WANdisco\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("安装：")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("查看：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("git --version\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("之后上边的问题消失。")]),t._v(" "),s("p",[t._v("参考：")]),t._v(" "),s("ul",[s("li",[t._v("https://issues.jenkins-ci.org/browse/JENKINS-37229")]),t._v(" "),s("li",[t._v("https://github.com/sameersbn/docker-gitlab/issues/1968")])]),t._v(" "),s("h2",{attrs:{id:"_9-ansible-构建日志有乱码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-ansible-构建日志有乱码"}},[t._v("#")]),t._v(" 9，ansible 构建日志有乱码")]),t._v(" "),s("p",[t._v("通过 Jenkinsfile 调用的 ansible 命令，其中剧本中步骤名称使用的中文，在 Jenkins 的构建日志都都变成了 "),s("code",[t._v("??????")]),t._v("。")]),t._v(" "),s("p",[t._v("网上有的说更改 ansible 的配置文件，调整语言以解决此问题，但是调整之后并没有效果，其实还是 Jenkins 自身的语言影响的，此时在系统配置中，添加一条全局环境变量即可解决此问题：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("LANG = en_US.UTF-8\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"http://t.eryajf.net/imgs/2022/10/7668a8f5a8f9e28f.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"_10-jenkins-有任务无法-kill-提示即将关闭"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_10-jenkins-有任务无法-kill-提示即将关闭"}},[t._v("#")]),t._v(" 10，Jenkins-有任务无法 kill 提示即将关闭")]),t._v(" "),s("p",[t._v("如果一些同学在构建的时候，中途将该构建取消，但是又没能正常取消的时候，这个构建可能会一直夯在这里，最终拖垮 Jenkins。")]),t._v(" "),s("p",[t._v("构建日志中提示如下内容：")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("Click here to forcibly terminate running steps\nCancelling nested steps due to "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("timeout")]),t._v("\nBody did not finish within grace period"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" terminating with extreme prejudice\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[t._v("然后 Jenkins 主界面会提示"),s("code",[t._v("Jenkins 即将关闭")]),t._v("，其他构建也无法正常进行。")]),t._v(" "),s("p",[t._v("这个时候这个 job 怎么也无法取消，就算把 Jenkins 重启，之后仍然能看到这个 job 还卡在这里，拿着关键字在网上也搜不到解决办法。")]),t._v(" "),s("p",[t._v("如果想要彻底关闭这个构建，可执行如下方法关闭：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("http://ci.eryajf.net/job/ops-test/job/dev-demo/22/kill\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("在对应构建 ID 之后，拼上 kill 请求之后，即可将这个异常的构建彻底 kill 掉。")]),t._v(" "),s("h2",{attrs:{id:"_11-pipeline-中执行-curl-时双引号的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_11-pipeline-中执行-curl-时双引号的问题"}},[t._v("#")]),t._v(" 11，pipeline 中执行 curl 时双引号的问题")]),t._v(" "),s("p",[t._v("有时候在 pipeline 中会执行一些 curl 请求，此时大概率在请求体中的内容会有一些变量，那么就得使用双引号，而双引号被双引号包裹的时候，需要进行转义，但这里仍有一个需要注意的点，因为我们请求体通常为标准 json，被 Jenkins 执行的时候，一层转义下来会把所有的引号脱掉，导致执行异常，这个时候需要添加两个转义符来解决这个问题。")]),t._v(" "),s("p",[t._v("比如，在 shell 脚本中中我们的操作如下：")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("JOB_BASE_NAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test-job"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("reqJson")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{'),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("job_name"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(":"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${JOB_BASE_NAME}")]),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v('}"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请求的body内容为： '),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$reqJson")]),t._v('"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--request")]),t._v(" POST "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://test.eryajf.net/sendcards/'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'User-Agent: Jenkins'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--header")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${reqJson}")]),t._v('"')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("p",[t._v("此时脚本中是可以正常执行的，但是放到 Jenkins 的 pipeline 中，请求会变成：")]),t._v(" "),s("p",[s("code",[t._v("curl --location --request POST http://test.eryajf.net/sendcards/ --header 'User-Agent: Jenkins' --header 'Content-Type: application/json' -d '{job_name:test-job}'")])]),t._v(" "),s("p",[t._v("从而导致执行失败，此时放到 pipeline 里的代码应该如下：")]),t._v(" "),s("div",{staticClass:"language-groovy line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-groovy"}},[s("code",[t._v("script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    sh"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'''\n        JOB_BASE_NAME=\"test-job\"\n        reqJson=\"{\\\\\"job_name\\\\\":\\\\\"${JOB_BASE_NAME}\\\\\"}\"\n\n        echo \"请求的body内容为： $reqJson\"\n\n        curl --location --request POST 'http://test.eryajf.net/sendcards/' \\\n            --header 'User-Agent: Jenkins' --header 'Content-Type: application/json' \\\n            -d \"${reqJson}\"\n    '''")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("p",[t._v("使用双转义符，就能够正常请求了。")]),t._v(" "),s("p",[t._v("参考："),s("a",{attrs:{href:"https://stackoverflow.com/questions/56583357/escape-double-quotes-in-a-jenkins-pipeline-files-shell-command",target:"_blank",rel:"noopener noreferrer"}},[t._v("Escape double quotes in a Jenkins pipeline file's shell command"),s("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);