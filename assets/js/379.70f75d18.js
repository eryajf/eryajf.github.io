(window.webpackJsonp=window.webpackJsonp||[]).push([[379],{720:function(s,t,a){"use strict";a.r(t);var n=a(0),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("现在有好几台主机的 nginx 日志想要监控分析一下，那么，如何让远程主机的日志都乖乖的来到 elk 主机之上呢，这是一个需要考虑的问题，而这里，我就使用 rsyslog 来完成。")]),s._v(" "),t("p",[s._v("这种方式貌似针对于远程主机上只有单项日志的情况，就像我们现在做的，只处理 nginx 的访问日志一般的，如果还有更多的日志需要从远程转发到 elk 集群中，就需要用其他方式了，或者说我只会配置这么一种，更复杂的，目前还玩不转。后来哈，在当我测试 rsyslog 转发多个日志的时候，发现，里边配置规则过于复杂，分类方面也非常不给力，就此打住，一旦多个日志，直接用 filebeat 即可。")]),s._v(" "),t("p",[s._v("现在，废话不多说，直接进入正题。")]),s._v(" "),t("p",[s._v("目前的思路，可以通过下图了解：")]),s._v(" "),t("p",[t("img",{attrs:{src:"http://t.eryajf.net/imgs/2023/03/9e3fd8837da00c6c.jpg",alt:""}})]),s._v(" "),t("p",[s._v("说明：")]),s._v(" "),t("ul",[t("li",[s._v("图中举例了两台 nginx，其实可以有更多台 nginx 日志可以想后方转发。")]),s._v(" "),t("li",[s._v("双方以 rsyslog 作为桥梁，从而实现日志的中转运输。其中 nginx 主机上是发送端，elk 主机上是接收端。")]),s._v(" "),t("li",[s._v("针对不同的 nginx 日志，可以启动不同的 logstash 实例，然后将日志转发给 es。")]),s._v(" "),t("li",[s._v("由 es，统一将日志转给 kibana。")])]),s._v(" "),t("p",[s._v("基本上配置起来也就是按上边的思路走，一步步配置起来就好了。")]),s._v(" "),t("p",[s._v("主机情况：")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[s._v("主机")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("组件")])])]),s._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("172.16.37.157")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("Nginx，Rsyslog")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("10.100.120.82")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("Rsyslog，ELK")])])])]),s._v(" "),t("h2",{attrs:{id:"_1-nginx-日志-json-化。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-nginx-日志-json-化。"}},[s._v("#")]),s._v(" 1，nginx 日志 json 化。")]),s._v(" "),t("p",[s._v("首先来配置 nginx 端的日志，为了方便后边一系列的操作，需要先把 nginx 的日志 json 化，要配置也非常简单，通过编辑 nginx 的配置文件来实现：")]),s._v(" "),t("p",[s._v("在 nginx 的配置文件 nginx.conf 的 http 区域添加如下内容：")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[s._v("log_format json '"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"@timestamp"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$time_iso8601"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("'\n                 '"),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"host"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$server_addr"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("'\n                 '"),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"request_method"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$request_method"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" '\n                 '"),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"clientip"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$remote_addr"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("'\n                 '"),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"size"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("$body_bytes_sent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("'\n                 '"),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"responsetime"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("$request_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("'\n                 '"),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"upstreamtime"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$upstream_response_time"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("'\n                 '"),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"upstreamhost"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$upstream_addr"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("'\n                 '"),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"http_host"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$host"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("'\n                 '"),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"url"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$uri"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("'\n                 '"),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"xff"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$http_x_forwarded_for"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("'\n                 '"),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"referer"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$http_referer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("'\n                 '"),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"agent"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$http_user_agent"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("'\n                 '"),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"status"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$status"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("';\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("注意，这个地方的配置，其实是非常重要的，里边定义了许多的字段（可能还不明白字段是什么意思，等到后边会慢慢介绍这个东东），这些字段取自于原 nginx 日志，然后再转给 es，最后通过 kibana 展示出来，从而让分析更加多维，立体，简单说明一下这些参数：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("timestamp")]),s._v("：日志的时间戳。")]),s._v(" "),t("li",[t("code",[s._v("host")]),s._v("：nginx 所在主机 IP。")]),s._v(" "),t("li",[t("code",[s._v("request_method")]),s._v("：请求类型（POST，GET）")]),s._v(" "),t("li",[t("code",[s._v("clientip")]),s._v("：前端 ip。")]),s._v(" "),t("li",[t("code",[s._v("size")]),s._v("：请求大小。")]),s._v(" "),t("li",[t("code",[s._v("responsetime")]),s._v("：请求响应时间。")]),s._v(" "),t("li",[t("code",[s._v("upstreamtime")]),s._v("：后端相应请求时间。")]),s._v(" "),t("li",[t("code",[s._v("upstreamhost")]),s._v("：后端服务器 IP。")]),s._v(" "),t("li",[t("code",[s._v("http_host")]),s._v("：域名。")]),s._v(" "),t("li",[t("code",[s._v("url")]),s._v("：请求的接口。")]),s._v(" "),t("li",[t("code",[s._v("xff")]),s._v("：用户 IP。")]),s._v(" "),t("li",[t("code",[s._v("referer")]),s._v("：完整请求地址。")]),s._v(" "),t("li",[t("code",[s._v("agent")]),s._v("：客户端类型。")]),s._v(" "),t("li",[t("code",[s._v("status")]),s._v("：状态码。")])]),s._v(" "),t("p",[s._v("其中的"),t("code",[s._v("clientip")]),s._v("常规情况下就是指请求的来源 IP 地址，下边的"),t("code",[s._v("xff")]),s._v("也是，原因是我们的环境当中在 nginx 节点之前，还有一层 waf，所以此时代表请求的来源 IP 地址的，则是"),t("code",[s._v("xff")]),s._v("，这个字段用意，将会在后边说明。")]),s._v(" "),t("p",[s._v("然后在 nginx 的访问日志配置 access_log 处更改配置如下：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("access_log /var/log/nginx/access.log json;\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("此处的 json 是与上边的"),t("code",[s._v("log_format")]),s._v("后边的名称相对应的，保持一致即可。如果有多台，可以将如上配置配置过去，这里我就不一一列举了，就拿这台 nginx 作为示例了。下边也一样，不再配置多台。")]),s._v(" "),t("h2",{attrs:{id:"_2-发送端配置。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-发送端配置。"}},[s._v("#")]),s._v(" 2，发送端配置。")]),s._v(" "),t("p",[s._v("现在开始编辑 rsyslog 发送端的配置，直接编辑 rsyslog 的配置文件，这里以其中一台服务器的 nginx 日志作为示例，通过 rsyslog 将 nginx 的访问日志转发到 elk 主机上去。")]),s._v(" "),t("p",[s._v("说明有二：")]),s._v(" "),t("ul",[t("li",[s._v("默认我这里使用的是 CentOS7 的主机，已经安装了 rsyslog-8.x 的服务。")]),s._v(" "),t("li",[s._v("还有主机是 CentOS-6.x 的，可能 rsyslog 版本很低，这个解决非常简单，通过如下两条命令安装即可。")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://rpms.adiscon.com/v8-stable/rsyslog.repo "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-O")]),s._v(" /etc/yum.repos.d/rsyslog.repo\nyum "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" rsyslog\nrsyslogd "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("接下来列出配置内容：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost curl"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$egrep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^#|^$"')]),s._v(" /etc/rsyslog.conf\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ModLoad")]),s._v(" imfile\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$InputFilePollInterval")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$WorkDirectory")]),s._v(" /var/spool/rsyslog\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PrivDropToGroup")]),s._v(" adm\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$InputFileName")]),s._v(" /var/log/nginx/access.log\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$InputFileTag")]),s._v(" nginx-access:\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$InputFileStateFile")]),s._v(" stat-nginx-access\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$InputFileSeverity")]),s._v(" info\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$InputFilePersistStateInterval")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25000")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$InputRunFileMonitor")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$template")]),s._v(" BiglogFormatNginx,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%msg%'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$programname")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx-access'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" @10.100.120.82:514"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("BiglogFormatNginx\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("InputFileName")]),s._v("：定义日志文件位置，此处貌似不能使用*.log 来匹配。")]),s._v(" "),t("li",[t("code",[s._v("InputFileTag")]),s._v("：定义一个 tag，方便下边调用。")]),s._v(" "),t("li",[t("code",[s._v("template")]),s._v("：定义日志格式的模板。")]),s._v(" "),t("li",[t("code",[s._v("最后一句")]),s._v("：将日志转发给"),t("code",[s._v("10.100.120.82")]),s._v("的"),t("code",[s._v("UDP")]),s._v("（一个@表示 UDP，两个@表示 TCP）端口"),t("code",[s._v("514")]),s._v("，并应用模板"),t("code",[s._v("BiglogFormatNginx")]),s._v("。")])]),s._v(" "),t("h2",{attrs:{id:"_3-接收端配置。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-接收端配置。"}},[s._v("#")]),s._v(" 3，接收端配置。")]),s._v(" "),t("p",[s._v("接收端在 elk 主机之上，这里同样配置 rsyslog 作为接收端，然后将接收到的日志存在 elk 本地。配置内容如下：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$egrep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^#|^$"')]),s._v(" /etc/rsyslog.conf\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$template")]),s._v(" myformat,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%rawmsg%'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ActionFileDefaultTemplate")]),s._v(" myformat\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ModLoad")]),s._v(" imuxsock "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides support for local system logging (e.g. via logger command)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ModLoad")]),s._v(" imjournal "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides access to the systemd journal")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ModLoad")]),s._v(" immark  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# provides --MARK-- message capability")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ModLoad")]),s._v(" imudp\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$UDPServerRun")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("514")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ModLoad")]),s._v(" imtcp\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$InputTCPServerRun")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("514")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$WorkDirectory")]),s._v(" /var/lib/rsyslog\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$AllowedSender")]),s._v(" tcp, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".120.0/24,172.16.37.0/24\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$template")]),s._v(" Remote,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/logs/logstashfile/%fromhost-ip%/%fromhost-ip%_%'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$YEAR")]),s._v("%-%"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MONTH")]),s._v("%-%"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DAY")]),s._v('%.log"')]),s._v("\n:fromhost-ip, "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("isequal, "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1"')]),s._v(" ?Remote\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$IncludeConfig")]),s._v(" /etc/rsyslog.d/*.conf\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OmitLocalLogging")]),s._v(" on\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$IMJournalStateFile")]),s._v(" imjournal.state\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("说明：")]),s._v(" "),t("ul",[t("li",[s._v("1，在本机开启 upd,tcp 端口 514 接收日志。")]),s._v(" "),t("li",[s._v("2，接收的范围，是 IP 定义的，多个网段的话中间用逗号隔开。")]),s._v(" "),t("li",[s._v("3，接收到的日志存放模板，存在本地的/logs 目录下，这里注意需要创建对应目录。")]),s._v(" "),t("li",[s._v("4，不杰接受来自 elk 本机的日志。")])]),s._v(" "),t("p",[s._v("然后在两边都启动 rsyslog 服务。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("systemctl restart rsyslog\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" rsyslog\nsystemctl status rsyslog\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("等待一会儿，就能够在 elk 主机上看到日志目录生成了。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@elk logstashfile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$pwd")]),s._v("\n/logs/logstashfile\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@elk logstashfile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ls")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".37.157\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("然后进去看一下日志，发现就是远程主机当中已经 json 化的 nginx 访问日志。")]),s._v(" "),t("h2",{attrs:{id:"_4-配置-logstash。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-配置-logstash。"}},[s._v("#")]),s._v(" 4，配置 logstash。")]),s._v(" "),t("p",[s._v("接着就该考虑如何将远程转过来的 nginx 日志，呈现在 elk 集群当中，这里使用 logstash 进行日志的转发，配置如下：")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[s._v("cat > /etc/logstash/conf.d/nginx.conf << EOF\ninput "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    file "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        type => "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx-access"')]),s._v("\n        path => "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/logs/logstashfile/172.16.37.157/172.16.37.157_*.log"')]),s._v("\n        codec => "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"json"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nfilter "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    geoip "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        source => "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xff"')]),s._v("\n        fields => "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"city_name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"country_code2"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"country_name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"latitude"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"longitude"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"region_name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        remove_field => "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[geoip][latitude]"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[geoip][longitude]"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    json "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        source => "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message"')]),s._v("\n        target => "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jsoncontent"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\noutput "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    if "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" == "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx-access"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        elasticsearch "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            hosts => "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1:9200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n            manage_template => "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n            index => "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx-access-%{+YYYY-MM}"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nEOF\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br")])]),t("ul",[t("li",[s._v("1，input 定义日志的名称（type），位置（path），格式。可以定义多个。这里直接读取通过 rsyslog 放置到本地的日志。")]),s._v(" "),t("li",[s._v("2，filter 定义一些关键字段的过滤。通过 geoip 来实现 ip 的地理位置标识，注意这个地方我的 source 是 xff，上边我已经解释过这个原因，如果你的是常规情况，那么应该更改成 clientip。")]),s._v(" "),t("li",[s._v("3，output 定义标准输出，到本机的 9200 端口，最后的 index 是索引名称，可以自定义，如果是不同主机上的日志，可以在这个地方根据其 ip 不同来进行区分。")])]),s._v(" "),t("p",[s._v("注意：此处所配置的"),t("a",{attrs:{href:"https://dev.maxmind.com/zh-hans/geoip/legacy/geolite/",target:"_blank",rel:"noopener noreferrer"}},[s._v("geoip"),t("OutboundLink")],1),s._v("不需要像网上许多教程说的，还要再引用对应的数据库，因为目前最新版本的 elk 已经配备了相应的配置，这点，在等会儿启动的日志当中可以见分晓。")]),s._v(" "),t("p",[s._v("然后再将这个实例起来，通过此实例将日志转给 es。")]),s._v(" "),t("p",[s._v("启动时默认有一个 data 目录，为了方便以后多实例管理，所以单独创建一个，另外启动日志也可以输出一个，从而让运维更容易，同样也创建对应的目录。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/share/logstash/data1\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /logs/logstash_nohup\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("启动实例。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" /usr/share/logstash/bin/logstash "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /etc/logstash/conf.d/nginx.conf "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--path.data")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/share/logstash/data1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&>")]),s._v(" /logs/logstash_nohup/nginx.out "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("然后监听一下转发状况：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$tail")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" /logs/logstash_nohup/nginx.out\nWARNING可以忽略，因为我们启动的时候已经指定配置文件了。: Could not "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" logstash.yml "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" is typically located "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$LS_HOME")]),s._v("/config or /etc/logstash. You can specify the path using --path.settings. Continuing using the defaults\nCould not "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" log4j2 configuration at path /usr/share/logstash/config/log4j2.properties. Using default config "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" logs errors to the console\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("WARN "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:40.285 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("LogStash::Runner"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" multilocal - Ignoring the "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pipelines.yml'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" because modules or "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" line options are specified\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:40.300 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("LogStash::Runner"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" runner - Starting Logstash "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"logstash.version"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6.5.3"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:43.330 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Converge PipelineAction::Create"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" pipeline - Starting pipeline "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":pipeline_id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pipeline.workers"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pipeline.batch.size"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("125")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pipeline.batch.delay"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:43.733 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("-pipeline-manager"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" elasticsearch - Elasticsearch pool URLs updated "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":changes"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":removed"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", :added"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("http://127.0.0.1:9200/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("WARN "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:45.024 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("-pipeline-manager"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" elasticsearch - Restored connection to ES instance "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":url"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://127.0.0.1:9200/"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:46.660 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("-pipeline-manager"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" elasticsearch - ES Output version determined "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":es_version"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("WARN "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:46.663 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("-pipeline-manager"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" elasticsearch - Detected a "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(".x and above cluster: the "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" event field won't be used to determine the document _type "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":es_version"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:46.687 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("-pipeline-manager"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" elasticsearch - New Elasticsearch output "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":class"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"LogStash::Outputs::ElasticSearch"')]),s._v(", :hosts"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"//127.0.0.1:9200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:46.701 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Ruby-0-Thread-5: :1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" elasticsearch - Using mapping template from "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":path"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("nil"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:46.711 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("-pipeline-manager"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" geoip - Using geoip database "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":path"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/share/logstash/vendor/bundle/jruby/2.3.0/gems/logstash-filter-geoip-5.0.3-java/vendor/GeoLite2-City.mmdb"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:46.723 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Ruby-0-Thread-5: :1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" elasticsearch - Attempting to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" template "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":manage_template"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"template"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"logstash-*"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60001")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index.refresh_interval"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5s"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mappings"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_default_"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dynamic_templates"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_field"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"path_match"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"match_mapping_type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"string"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mapping"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"norms"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("false"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"string_fields"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"match"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"match_mapping_type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"string"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mapping"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"norms"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("false, "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fields"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keyword"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keyword"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ignore_above"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@timestamp"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"date"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@version"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keyword"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"geoip"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dynamic"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("true, "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ip"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ip"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"location"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"geo_point"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"latitude"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"half_float"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"longitude"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"half_float"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:46.989 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("worker15"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" beats - Beats inputs: Starting input listener "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":address"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0.0:5054"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:47.006 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Converge PipelineAction::Create"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" pipeline - Pipeline started successfully "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":pipeline_id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main"')]),s._v(", :thread"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#<Thread:0x31362ee1 run>"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:47.058 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Ruby-0-Thread-1: /usr/share/logstash/lib/bootstrap/environment.rb:6"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" agent - Pipelines running "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":count"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", :running_pipelines"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", :non_running_pipelines"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:47.061 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("beats"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Server - Starting server on port: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5054")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-12-18 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":49:47.290 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Api Webserver"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" agent - Successfully started Logstash API endpoint "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9610")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("p",[s._v("说明：")]),s._v(" "),t("p",[s._v("从这段日志当中，可以看出不少的信息，所以特别的拎出来了。")]),s._v(" "),t("ul",[t("li",[s._v("1，第一个 WARNING 可以忽略，因为我们启动的时候已经指定配置文件了。")]),s._v(" "),t("li",[s._v("2，启动之后开始连接配置当中指定的 127.0.0.1:9200。")]),s._v(" "),t("li",[s._v("3，接着会看到一个输出：")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("geoip - Using geoip database "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(":path"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/share/logstash/vendor/bundle/jruby/2.3.0/gems/logstash-filter-geoip-5.0.3-java/vendor/GeoLite2-City.mmdb"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这条输出的意思就是刚刚我提到的那个问题，系统其实已经有了对应的库，进行加载，当然，有可能这个库的新鲜度未必能够保证。需要注意的是，GeoLite 数据库由每月的第一个星期二的 MaxMind 更新，如果需要最新的，可以及时进行更新下载。")]),s._v(" "),t("ul",[t("li",[s._v("4，接着可以看到 es 加载了初始定义好了的模板进行数据处理。")]),s._v(" "),t("li",[s._v("5，直到一系列初始化完成，然后正式处理对应的日志到。")])]),s._v(" "),t("p",[s._v("过一会儿，会看到有大量日志输出，说明日志已经成功转发给 es，此时也可以去 kibana 当中创建一个对应的索引了。")]),s._v(" "),t("h2",{attrs:{id:"_5-简单使用-kibana。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-简单使用-kibana。"}},[s._v("#")]),s._v(" 5，简单使用 kibana。")]),s._v(" "),t("p",[s._v("现在来访问 kibana 做一些简单查看：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://ae01.alicdn.com/kf/HTB1nrRHaNv1gK0jSZFF7620sXXaZ.png",alt:"img"}})]),s._v(" "),t("ul",[t("li",[s._v("1，点击管理，进入到管理界面。")]),s._v(" "),t("li",[s._v("2，点击索引管理，可以看到 es 已经创建的索引。")]),s._v(" "),t("li",[s._v("3，点击索引模式，将 es 的索引引入到 kibana 当中。")])]),s._v(" "),t("p",[s._v("现在我们点击第三步，去创建一下索引：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://ae01.alicdn.com/kf/HTB1osNIaND1gK0jSZFK763JrVXaz.png",alt:"img"}})]),s._v(" "),t("p",[s._v("点击进来之后，就能看到刚刚我们定义的索引了，现在我创建一个以"),t("code",[s._v("nginx-access*")]),s._v("命名的索引（这个地方所列出来的索引，都是在 logstash 的配置当中定义了的索引），点击下一步。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://ae01.alicdn.com/kf/HTB1DLFHaQT2gK0jSZPc763KkpXaj.png",alt:"img"}})]),s._v(" "),t("p",[s._v("选择索引的模式，这里一般都使用"),t("code",[s._v("timestamp")]),s._v("，即以时间作为标准。然后点击创建即可。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://ae01.alicdn.com/kf/HTB140JEaFY7gK0jSZKz761ikpXaH.png",alt:"img"}})]),s._v(" "),t("p",[s._v("创建成功之后，能够看到一些我们前边定义好了的字段，这些字段也将成为我们日后分析日志的重要依据，可能你现在对字段是什么，还不能十分理解，不用着急，慢慢往后看，咱们一起边做边理解。")]),s._v(" "),t("p",[s._v("现在可以去看一下，前台日志展示页面是否成功了：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://ae01.alicdn.com/kf/HTB1xkK9X1bviK0jSZFN761ApXXaE.png",alt:"img"}})]),s._v(" "),t("p",[s._v("可以看到日志已经呈现在眼前了，到这里，可以说，基本上 elk 的整个流程就算是走通了。")]),s._v(" "),t("p",[s._v("貌似一般情况下，网上教程都是到这个地方就结束了，然而，事情难道不是刚刚开始么。")]),s._v(" "),t("p",[s._v("接着，我们先来看一下我们前边多次提到的字段是否如我们所愿的展示了，查看的方法也很简单，随便点击其中一条日志，查看其 json 的格式：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://ae01.alicdn.com/kf/HTB1DHXIaQL0gK0jSZFx760WHVXas.png",alt:"img"}})]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"_index"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx-access-2018-12"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"_type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doc"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"_id"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"USJ_wWcBSQAerHbVQR9q"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"_version"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"_score"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token null keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"_source"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"xff"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"183.214.48.249"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"request_method"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"POST"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"host"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.16.37.157"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"agent"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"upstreamtime"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.004"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"@timestamp"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2018-12-18T13:26:40.000Z"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"referer"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://h5.51fanbei.com/h5/activity/201806/wxIndexHelp.html?inviteUser=NpCYtbHZVkqufRMsZvVqNg==&freeOrder=WHaDtQnCpE9BSOnAB9LVxQ=="')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"upstreamhost"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.16.37.158:8080"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"clientip"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.16.37.161"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"responsetime"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.005")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"url"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/fanbei-web/activity/freeOrder/showHelpGoods"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"status"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"size"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("76")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"@version"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx-access"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"path"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/logs/logstashfile/172.16.37.157/172.16.37.157_2018-12-18.log"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"geoip"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"country_code2"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CN"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"city_name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Changsha"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"region_name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hunan"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"country_name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"China"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"http_host"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"app.51fanbei.com"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"fields"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"@timestamp"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2018-12-18T13:26:40.000Z"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"sort"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1545139600000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br")])]),t("p",[s._v("这样一展示之后，就能看出，清晰多了，我们所想要的，都生成了，稍候就能够通过这些数据，来进行画图等操作。")])])}),[],!1,null,null,null);t.default=r.exports}}]);