(window.webpackJsonp=window.webpackJsonp||[]).push([[352],{696:function(n,t,s){"use strict";s.r(t);var a=s(0),e=Object(a.a)({},(function(){var n=this,t=n._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("h2",{attrs:{id:"_1-升级。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-升级。"}},[n._v("#")]),n._v(" 1，升级。")]),n._v(" "),t("p",[n._v("Jenkins 的版本方面，分有稳定版和开发版两大类，其中开发版是每周更新一个版本，稳定版则是每三个月在开发版当中选取一个版本进行更新。")]),n._v(" "),t("p",[n._v("一般企业当中使用的是稳定版，在一定时间跟随更新版本，也非常必要。")]),n._v(" "),t("p",[n._v("更新其实也非常简单，下载新版本的 war 包，将旧版本的包替换即可。")]),n._v(" "),t("p",[n._v("如果不够放心，可以将老版本的 war 包以及 JENKINS_HOME 目录进行备份，然后再升级。")]),n._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[n._v("14")]),n._v("-Jan-2019 "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("10")]),n._v(":36:20.800 INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("pool-6-thread-2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" jenkins.InitReactorRunner"),t("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$1")]),n._v(".onAttained Started initialization\n"),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("14")]),n._v("-Jan-2019 "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("10")]),n._v(":36:20.826 INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("Loading bundled plugins"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" hudson.PluginManager.loadDetachedPlugins Upgrading Jenkins. The last running version was "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("2.100")]),n._v(". This Jenkins is version "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("2.157")]),n._v(".\n"),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("14")]),n._v("-Jan-2019 "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("10")]),n._v(":36:21.382 INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("Loading bundled plugins"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" hudson.PluginManager.loadDetachedPlugins Upgraded Jenkins from version "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("2.100")]),n._v(" to version "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("2.157")]),n._v(". Loaded detached plugins "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("and dependencies"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(": "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("jdk-tool.hpi"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("14")]),n._v("-Jan-2019 "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("10")]),n._v(":36:30.717 INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("pool-6-thread-1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" jenkins.InitReactorRunner"),t("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$1")]),n._v(".onAttained Listed all plugins\n"),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("14")]),n._v("-Jan-2019 "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("10")]),n._v(":36:34.235 INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("Loading plugin Keychains and Provisioning Profiles Management v1.0.0 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("kpp-management-plugin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" com.sic.plugins.kpp.KPPPlugin.start starting kpp plugin\n"),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("14")]),n._v("-Jan-2019 "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("10")]),n._v(":36:35.348 INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("Loading plugin AnsiColor v0.5.2 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("ansicolor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" hudson.plugins.ansicolor.PluginImpl.start AnsiColor: eliminating boring output "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("https://github.com/jenkinsci/ansicolor-plugin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("14")]),n._v("-Jan-2019 "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("10")]),n._v(":36:35.377 INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("Loading plugin Gerrit Trigger v2.28.0 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("gerrit-trigger"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" com.sonyericsson.hudson.plugins.gerrit.trigger.PluginImpl.start Starting Gerrit-Trigger Plugin\n"),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("14")]),n._v("-Jan-2019 "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("10")]),n._v(":36:35.468 INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("Loading plugin Gerrit Trigger v2.28.0 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("gerrit-trigger"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" com.sonymobile.tools.gerrit.gerritevents.GerritSendCommandQueue.startQueue SendQueue started"),t("span",{pre:!0,attrs:{class:"token operator"}},[n._v("!")]),n._v(" Current pool size: "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),n._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("14")]),n._v("-Jan-2019 "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("10")]),n._v(":36:44.591 INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("pool-6-thread-1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" jenkins.InitReactorRunner"),t("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$1")]),n._v(".onAttained Prepared all plugins\n"),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("14")]),n._v("-Jan-2019 "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("10")]),n._v(":36:44.676 INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("Initializing plugin gerrit-trigger"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" com.sonyericsson.hudson.plugins.gerrit.trigger.replication.ReplicationCache.initialize initialized replication cache with expiration "),t("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("in")]),n._v(" MINUTES: "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("360")]),n._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("14")]),n._v("-Jan-2019 "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("10")]),n._v(":36:44.676 WARNING "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("Initializing plugin gerrit-trigger"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" com.sonyericsson.hudson.plugins.gerrit.trigger.replication.ReplicationQueueTaskDispatcher."),t("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v("init"),t("span",{pre:!0,attrs:{class:"token operator"}},[n._v(">")]),n._v(" No GerritHandler was specified, won't register as event listener, so no function.\n"),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("14")]),n._v("-Jan-2019 "),t("span",{pre:!0,attrs:{class:"token number"}},[n._v("10")]),n._v(":36:45.167 INFO "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("pool-6-thread-2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" jenkins.InitReactorRunner"),t("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$1")]),n._v(".onAttained Started all plugins\n")])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br"),t("span",{staticClass:"line-number"},[n._v("6")]),t("br"),t("span",{staticClass:"line-number"},[n._v("7")]),t("br"),t("span",{staticClass:"line-number"},[n._v("8")]),t("br"),t("span",{staticClass:"line-number"},[n._v("9")]),t("br"),t("span",{staticClass:"line-number"},[n._v("10")]),t("br"),t("span",{staticClass:"line-number"},[n._v("11")]),t("br"),t("span",{staticClass:"line-number"},[n._v("12")]),t("br")])]),t("p",[n._v("这段日志很细致的记录了整个升级过程的一些经历！")]),n._v(" "),t("p",[t("code",[n._v("注意，我的这个升级操作，是基于2.x往2.x升级的实验，并没有试验过1.x往2.x的升级，可能会出现不可预知的问题。")])]),n._v(" "),t("p",[t("img",{attrs:{src:"http://t.eryajf.net/imgs/2021/09/c14d7b151fa34bcc.jpg",alt:"image"}})]),n._v(" "),t("h2",{attrs:{id:"_2-迁移。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-迁移。"}},[n._v("#")]),n._v(" 2，迁移。")]),n._v(" "),t("p",[n._v("迁移相对于升级，会有更多的挑战，这些挑战，只有经历之后，才能拥有这部分的经验，这才真真正正与打怪升级一般，如果你从来没有做过迁移，可能直接将所有东西一股脑同步过去，就算迁移了，事实上，这里边还是有一些技巧的。")]),n._v(" "),t("p",[n._v("比如这两天我完成了一次老服务器的迁移，就经历了这个过程。")]),n._v(" "),t("p",[n._v("因为太久了，项目已经一百三四十个，所以整个"),t("code",[n._v(".jenkins")]),n._v("目录已经达到了 50G，我的迁移过程就是，苦苦打包，又苦苦传输，再苦苦解压之后，终于得以启用。")]),n._v(" "),t("p",[n._v("后来整个迁移好了之后，我在旧的上边做起试验来，试验内容就是：")]),n._v(" "),t("ul",[t("li",[t("p",[n._v("1，先把整个 wordspace（将近 34G）目录删除，看看有哪些影响。")]),n._v(" "),t("p",[n._v("删除之后，发现项目都还在，只不过构建历史里边的内容都没有了。")])]),n._v(" "),t("li",[t("p",[n._v("2，再把整个 jobs（将近 16G）目录删除，看看有哪些影响。")]),n._v(" "),t("p",[n._v("删除之后，发现项目都还在，似乎没有什么影响。")])])]),n._v(" "),t("p",[n._v("而经过这样一波操作之后，剩下的，就差不多 1G 左右，这样以来，迁移工作就马上变得轻松简单起来了！")])])}),[],!1,null,null,null);t.default=e.exports}}]);